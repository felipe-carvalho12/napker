{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\felip\\\\CodeProjects\\\\Web\\\\Napker\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{Link}from'react-router-dom';import Modal from'react-bootstrap/Modal';import Picker from'emoji-picker-react';import Header from'../components/fixed/Header';import Posts from'./profile-components/Posts';import Interests from'./profile-components/Interests';import{SERVER_URL}from'../settings';import{csrftoken,openCloseEmojiList}from'../utils';export default function MyProfile(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),profile=_useState2[0],setProfile=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),profileImagePreview=_useState4[0],setProfileImagePreview=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isEditing=_useState6[0],setIsEditing=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),editingBioContent=_useState8[0],setEditingBioContent=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),currentPageIsPosts=_useState10[0],setCurrentPageIsPosts=_useState10[1];document.title='Perfil / Napker';useEffect(function(){fetchProfile();},[]);var fetchProfile=function fetchProfile(){fetch(\"\".concat(SERVER_URL,\"/profile-api/myprofile\")).then(function(response){return response.json();}).then(function(data){setProfile(data);setProfileImagePreview(\"\".concat(SERVER_URL).concat(data.photo));});};var switchPage=function switchPage(e){document.querySelectorAll('.profile-page-menu-item-active').forEach(function(el){el.classList.remove('profile-page-menu-item-active');});e.target.classList.add('profile-page-menu-item-active');if(e.target.id==='profile-posts-page-menu-item'){setCurrentPageIsPosts(true);}else if(e.target.id==='profile-interests-page-menu-item'){setCurrentPageIsPosts(false);}};var handleProfileImageChange=function handleProfileImageChange(e){var reader=new FileReader();reader.onload=function(){if(reader.readyState===2){setProfileImagePreview(reader.result);}};try{reader.readAsDataURL(e.target.files[0]);}catch(_unused){}};var handleUsernameChange=function handleUsernameChange(e){if(e.target.value.trim()!==''){fetch(\"\".concat(SERVER_URL,\"/profile-api/user/\").concat(e.target.value)).then(function(response){return response.json();}).then(function(data){if(data.bool!=='false'&&data.id!==profile.id){document.querySelector('#username-taken').style.display='initial';}else{document.querySelector('#username-taken').style.display='none';}});}};var onEmojiSelect=function onEmojiSelect(event,emojiObject){setEditingBioContent(editingBioContent+emojiObject.emoji);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Header,{page:\"Perfil\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"content\"},profile?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Modal,{show:isEditing,onHide:function onHide(){return setIsEditing(false);},size:\"lg\"},/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true},/*#__PURE__*/React.createElement(Modal.Title,null,\"Editar perfil\")),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"form\",{action:\"\".concat(SERVER_URL,\"/update-profile\"),className:\"d-flex flex-column justify-content-center\",id:\"update-profile-form\",method:\"POST\",encType:\"multipart/form-data\"},/*#__PURE__*/React.createElement(\"input\",{type:\"hidden\",name:\"csrfmiddlewaretoken\",value:csrftoken}),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-column justify-content-center align-items-center mb-2\"},/*#__PURE__*/React.createElement(\"img\",{src:profileImagePreview,className:\"profile-img-big\",style:{marginBottom:'25px'}}),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",accept:\"image/png, image/jpg, image/jpeg\",className:\"profile-photo-input\",name:\"profile-photo\",onChange:handleProfileImageChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-center\"},\"Email: \",profile.email),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"edit-profile-input\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"first-name\",className:\"profile-field-label\"},\"Nome:\"),/*#__PURE__*/React.createElement(\"input\",{className:\"profile-field-input\",type:\"text\",name:\"first-name\",id:\"first-name\",placeholder:profile.first_name})),/*#__PURE__*/React.createElement(\"div\",{className:\"edit-profile-input\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"last-name\",className:\"profile-field-label\"},\"Sobrenome:\"),/*#__PURE__*/React.createElement(\"input\",{className:\"profile-field-input\",type:\"text\",name:\"last-name\",id:\"last-name\",placeholder:profile.last_name})),/*#__PURE__*/React.createElement(\"div\",{className:\"edit-profile-input\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"username\",className:\"profile-field-label\"},\"Nome de usu\\xE1rio:\"),/*#__PURE__*/React.createElement(\"input\",{className:\"profile-field-input\",type:\"text\",name:\"username\",id:\"username\",placeholder:profile.user.username,onChange:handleUsernameChange})),/*#__PURE__*/React.createElement(\"div\",{id:\"username-taken\",style:{display:'none',width:'100%',textAlign:'center',padding:'3px'}},/*#__PURE__*/React.createElement(\"span\",null,\"Nome de usu\\xE1rio j\\xE1 existe\")),/*#__PURE__*/React.createElement(\"div\",{className:\"edit-profile-input\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"birth-date\",className:\"profile-field-label\"},\"Data de nascimento:\"),/*#__PURE__*/React.createElement(\"input\",{className:\"profile-field-input\",type:\"date\",name:\"birth-date\",id:\"birth-date\",defaultValue:profile.birth_date})),/*#__PURE__*/React.createElement(\"div\",{className:\"emoji-list-container bio-emoji-list\",id:\"emoji-list-container\"},/*#__PURE__*/React.createElement(Picker,{onEmojiClick:onEmojiSelect})),/*#__PURE__*/React.createElement(\"div\",{className:\"edit-profile-input\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"bio\",className:\"profile-field-label\"},\"Bio:\"),/*#__PURE__*/React.createElement(\"div\",{className:\"email-input-container\"},/*#__PURE__*/React.createElement(\"input\",{className:\"profile-field-input-email\",type:\"email\",name:\"bio\",id:\"bio\",value:editingBioContent,placeholder:profile.bio,onChange:function onChange(e){return setEditingBioContent(e.target.value);}}),/*#__PURE__*/React.createElement(\"label\",{className:\"far fa-smile\",id:\"emoji-button\",onClick:function onClick(){return openCloseEmojiList(false);}}))))),/*#__PURE__*/React.createElement(Modal.Footer,null,/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-grey\",onClick:function onClick(){return setIsEditing(false);}},\"Fechar\"),/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary\",onClick:function onClick(){return document.querySelector('form#update-profile-form').submit();}},\"Salvar\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-data-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-column align-items-start\",style:{textAlign:'start'}},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"img\",{src:\"\".concat(SERVER_URL).concat(profile.photo),className:\"profile-img-big\",style:{marginBottom:'25px'}})),/*#__PURE__*/React.createElement(\"p\",{style:{marginBottom:0}},/*#__PURE__*/React.createElement(\"strong\",null,profile.first_name,\" \",profile.last_name)),/*#__PURE__*/React.createElement(\"p\",{className:\"text-secondary\",style:{marginTop:0}},\"@\",profile.user.username),/*#__PURE__*/React.createElement(\"p\",null,profile.bio),/*#__PURE__*/React.createElement(\"p\",{className:\"text-secondary\"},/*#__PURE__*/React.createElement(\"i\",{className:\"far fa-calendar-alt\"}),\" Entrou em \",profile.created.split('-').reverse().join('/')),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(Link,{to:\"/user/\".concat(profile.slug,\"/amigos\"),style:{color:'#000'}},/*#__PURE__*/React.createElement(\"strong\",null,profile.friends.length),\" \",profile.friends.length===1?'amigo':'amigos'))),/*#__PURE__*/React.createElement(\"div\",{className:\"myprofile-btn-wrapper\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-secondary\",type:\"button\",onClick:function onClick(){return setIsEditing(true);},style:{marginBottom:'10px'}},\"Editar perfil\"),/*#__PURE__*/React.createElement(Link,{to:\"/perfil/meus-interesses\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-secondary\"},\"Editar interesses\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-page-menu\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-page-menu-item profile-page-menu-item-active\",id:\"profile-posts-page-menu-item\",onClick:switchPage},\"Posts (\",profile.posts.length,\")\"),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-page-menu-item\",id:\"profile-interests-page-menu-item\",onClick:switchPage},\"Interesses (\",profile.interests.filter(function(i){return i.public;}).length,\")\")),currentPageIsPosts?/*#__PURE__*/React.createElement(Posts,{profile:profile,fetchProfile:fetchProfile}):/*#__PURE__*/React.createElement(Interests,{profile:profile})):/*#__PURE__*/React.createElement(\"div\",{className:\"profile-page-loader-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"loader\"}))));}","map":{"version":3,"sources":["C:/Users/felip/CodeProjects/Web/Napker/frontend/src/pages/MyProfile.js"],"names":["React","useEffect","useState","Link","Modal","Picker","Header","Posts","Interests","SERVER_URL","csrftoken","openCloseEmojiList","MyProfile","profile","setProfile","profileImagePreview","setProfileImagePreview","isEditing","setIsEditing","editingBioContent","setEditingBioContent","currentPageIsPosts","setCurrentPageIsPosts","document","title","fetchProfile","fetch","then","response","json","data","photo","switchPage","e","querySelectorAll","forEach","el","classList","remove","target","add","id","handleProfileImageChange","reader","FileReader","onload","readyState","result","readAsDataURL","files","handleUsernameChange","value","trim","bool","querySelector","style","display","onEmojiSelect","event","emojiObject","emoji","marginBottom","email","first_name","last_name","user","username","width","textAlign","padding","birth_date","bio","submit","marginTop","created","split","reverse","join","slug","color","friends","length","posts","interests","filter","i","public"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport Modal from 'react-bootstrap/Modal'\r\nimport Picker from 'emoji-picker-react'\r\n\r\nimport Header from '../components/fixed/Header'\r\nimport Posts from './profile-components/Posts'\r\nimport Interests from './profile-components/Interests'\r\nimport { SERVER_URL } from '../settings'\r\nimport { csrftoken, openCloseEmojiList } from '../utils'\r\n\r\nexport default function MyProfile() {\r\n    const [profile, setProfile] = useState(null)\r\n    const [profileImagePreview, setProfileImagePreview] = useState(null)\r\n    const [isEditing, setIsEditing] = useState(false)\r\n    const [editingBioContent, setEditingBioContent] = useState('')\r\n    const [currentPageIsPosts, setCurrentPageIsPosts] = useState(true)\r\n\r\n    document.title = 'Perfil / Napker'\r\n\r\n    useEffect(() => {\r\n        fetchProfile()\r\n    }, [])\r\n\r\n    const fetchProfile = () => {\r\n        fetch(`${SERVER_URL}/profile-api/myprofile`)\r\n            .then(response => response.json())\r\n            .then(data => {\r\n                setProfile(data)\r\n                setProfileImagePreview(`${SERVER_URL}${data.photo}`)\r\n            })\r\n    }\r\n\r\n    const switchPage = e => {\r\n        document.querySelectorAll('.profile-page-menu-item-active').forEach(el => {\r\n            el.classList.remove('profile-page-menu-item-active')\r\n        })\r\n        e.target.classList.add('profile-page-menu-item-active')\r\n        if (e.target.id === 'profile-posts-page-menu-item') {\r\n            setCurrentPageIsPosts(true)\r\n        } else if (e.target.id === 'profile-interests-page-menu-item') {\r\n            setCurrentPageIsPosts(false)\r\n        }\r\n    }\r\n\r\n    const handleProfileImageChange = e => {\r\n        const reader = new FileReader()\r\n        reader.onload = () => {\r\n            if (reader.readyState === 2) {\r\n                setProfileImagePreview(reader.result)\r\n            }\r\n        }\r\n        try {\r\n            reader.readAsDataURL(e.target.files[0])\r\n        } catch {\r\n\r\n        }\r\n    }\r\n\r\n\r\n    const handleUsernameChange = e => {\r\n        if (e.target.value.trim() !== '') {\r\n            fetch(`${SERVER_URL}/profile-api/user/${e.target.value}`)\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    if (data.bool !== 'false' && data.id !== profile.id) {\r\n                        document.querySelector('#username-taken').style.display = 'initial'\r\n                    } else {\r\n                        document.querySelector('#username-taken').style.display = 'none'\r\n                    }\r\n                })\r\n        }\r\n    }\r\n\r\n    const onEmojiSelect = (event, emojiObject) => {\r\n        setEditingBioContent(editingBioContent + emojiObject.emoji)\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Header page=\"Perfil\" />\r\n            <div className=\"content\">\r\n                {profile ?\r\n                    <>\r\n                        <Modal show={isEditing}\r\n                            onHide={() => setIsEditing(false)}\r\n                            size=\"lg\">\r\n                            <Modal.Header closeButton>\r\n                                <Modal.Title>Editar perfil</Modal.Title>\r\n                            </Modal.Header>\r\n                            <Modal.Body>\r\n                                <form\r\n                                    action={`${SERVER_URL}/update-profile`}\r\n                                    className=\"d-flex flex-column justify-content-center\"\r\n                                    id=\"update-profile-form\"\r\n                                    method=\"POST\"\r\n                                    encType=\"multipart/form-data\"\r\n                                >\r\n                                    <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value={csrftoken} />\r\n                                    <div className=\"d-flex flex-column justify-content-center align-items-center mb-2\">\r\n                                        <img src={profileImagePreview}\r\n                                            className=\"profile-img-big\"\r\n                                            style={{ marginBottom: '25px' }}\r\n                                        />\r\n                                        <input\r\n                                            type=\"file\"\r\n                                            accept=\"image/png, image/jpg, image/jpeg\"\r\n                                            className=\"profile-photo-input\"\r\n                                            name=\"profile-photo\"\r\n                                            onChange={handleProfileImageChange}\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"d-flex justify-content-center\">\r\n                                        Email: {profile.email}\r\n                                    </div>\r\n                                    <hr />\r\n                                    <div className=\"edit-profile-input\">\r\n                                        <label htmlFor=\"first-name\" className=\"profile-field-label\">Nome:</label>\r\n                                        <input className=\"profile-field-input\" type=\"text\" name=\"first-name\" id=\"first-name\" placeholder={profile.first_name} />\r\n                                    </div>\r\n                                    <div className=\"edit-profile-input\">\r\n                                        <label htmlFor=\"last-name\" className=\"profile-field-label\">Sobrenome:</label>\r\n                                        <input className=\"profile-field-input\" type=\"text\" name=\"last-name\" id=\"last-name\" placeholder={profile.last_name} />\r\n                                    </div>\r\n                                    <div className=\"edit-profile-input\">\r\n                                        <label htmlFor=\"username\" className=\"profile-field-label\">Nome de usuário:</label>\r\n                                        <input\r\n                                            className=\"profile-field-input\"\r\n                                            type=\"text\"\r\n                                            name=\"username\"\r\n                                            id=\"username\"\r\n                                            placeholder={profile.user.username}\r\n                                            onChange={handleUsernameChange}\r\n                                        />\r\n                                    </div>\r\n                                    <div\r\n                                        id=\"username-taken\"\r\n                                        style={{ display: 'none', width: '100%', textAlign: 'center', padding: '3px' }}\r\n                                    >\r\n                                        <span>Nome de usuário já existe</span>\r\n                                    </div>\r\n                                    <div className=\"edit-profile-input\">\r\n                                        <label htmlFor=\"birth-date\" className=\"profile-field-label\">Data de nascimento:</label>\r\n                                        <input className=\"profile-field-input\" type=\"date\" name=\"birth-date\" id=\"birth-date\" defaultValue={profile.birth_date} />\r\n                                    </div>\r\n                                    <div className=\"emoji-list-container bio-emoji-list\" id=\"emoji-list-container\">\r\n                                        <Picker onEmojiClick={onEmojiSelect} />\r\n                                    </div>\r\n                                    <div className=\"edit-profile-input\">\r\n                                        <label htmlFor=\"bio\" className=\"profile-field-label\">Bio:</label>\r\n                                        <div className=\"email-input-container\">\r\n                                            <input\r\n                                                className=\"profile-field-input-email\"\r\n                                                type=\"email\"\r\n                                                name=\"bio\"\r\n                                                id=\"bio\"\r\n                                                value={editingBioContent}\r\n                                                placeholder={profile.bio}\r\n                                                onChange={e => setEditingBioContent(e.target.value)}\r\n                                            />\r\n                                            <label\r\n                                                className=\"far fa-smile\"\r\n                                                id=\"emoji-button\"\r\n                                                onClick={() => openCloseEmojiList(false)}\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </form>\r\n                            </Modal.Body>\r\n                            <Modal.Footer>\r\n                                <button className=\"btn btn-grey\" onClick={() => setIsEditing(false)}>Fechar</button>\r\n                                <button className=\"btn btn-primary\" onClick={() => document.querySelector('form#update-profile-form').submit()}>Salvar</button>\r\n                            </Modal.Footer>\r\n                        </Modal>\r\n                        <div className=\"profile-data-container\">\r\n                            <div className=\"d-flex flex-column align-items-start\" style={{ textAlign: 'start' }}>\r\n                                <p>\r\n                                    <img src={`${SERVER_URL}${profile.photo}`}\r\n                                        className=\"profile-img-big\"\r\n                                        style={{ marginBottom: '25px' }}\r\n                                    />\r\n                                </p>\r\n                                <p style={{ marginBottom: 0 }}><strong>{profile.first_name} {profile.last_name}</strong></p>\r\n                                <p className=\"text-secondary\" style={{ marginTop: 0 }}>@{profile.user.username}</p>\r\n                                <p>{profile.bio}</p>\r\n                                <p className=\"text-secondary\">\r\n                                    <i className=\"far fa-calendar-alt\"></i> Entrou em {profile.created.split('-').reverse().join('/')}\r\n                                </p>\r\n                                <p>\r\n                                    <Link to={`/user/${profile.slug}/amigos`} style={{ color: '#000' }}>\r\n                                        <strong>{profile.friends.length}</strong> {profile.friends.length === 1 ? 'amigo' : 'amigos'}\r\n                                    </Link>\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"myprofile-btn-wrapper\">\r\n                                <button\r\n                                    className=\"btn btn-secondary\"\r\n                                    type=\"button\"\r\n                                    onClick={() => setIsEditing(true)}\r\n                                    style={{ marginBottom: '10px' }}\r\n                                >\r\n                                    Editar perfil\r\n                                </button>\r\n                                <Link to='/perfil/meus-interesses'>\r\n                                    <button className=\"btn btn-secondary\">Editar interesses</button>\r\n                                </Link>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"profile-page-menu\">\r\n                            <div\r\n                                className=\"profile-page-menu-item profile-page-menu-item-active\"\r\n                                id=\"profile-posts-page-menu-item\"\r\n                                onClick={switchPage}\r\n                            >\r\n                                Posts ({profile.posts.length})\r\n                            </div>\r\n                            <div\r\n                                className=\"profile-page-menu-item\"\r\n                                id=\"profile-interests-page-menu-item\"\r\n                                onClick={switchPage}\r\n                            >\r\n                                Interesses ({profile.interests.filter(i => i.public).length})\r\n                            </div>\r\n                        </div>\r\n                        {currentPageIsPosts ?\r\n                            <Posts profile={profile} fetchProfile={fetchProfile} /> :\r\n                            <Interests profile={profile} />\r\n                        }\r\n                    </> :\r\n                    <div className=\"profile-page-loader-container\">\r\n                        <div className=\"loader\" />\r\n                    </div>\r\n                }\r\n            </div>\r\n        </>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}