{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\felip\\\\CodeProjects\\\\Web\\\\Napker\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import Picker from'emoji-picker-react';import{Link}from'react-router-dom';import{SERVER_URL}from'../../../../../config/settings';import{csrftoken,openCloseEmojiList}from'../../../../../config/utils';export default function PostForm(props){var myProfile=props.myProfile;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),postContent=_useState2[0],setPostContent=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),postImage=_useState4[0],setPostImage=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),postFormImagePreview=_useState6[0],setPostFormImagePreview=_useState6[1];var handlePostContentChange=function handlePostContentChange(e){setPostContent(e.target.value);var el=document.querySelector('#post-form-submit-btn');el.disabled=e.target.value.trim()===''&&!postFormImagePreview;};var handlePostImageChange=function handlePostImageChange(e){setPostImage(e.target.value);var reader=new FileReader();reader.onload=function(){if(reader.readyState===2){setPostFormImagePreview(reader.result);document.querySelector('#post-img-container').style.display='initial';document.querySelector('#post-form-submit-btn').disabled=false;}};try{reader.readAsDataURL(e.target.files[0]);}catch(_unused){}};var handleCloseImage=function handleCloseImage(){setPostImage(null);document.querySelector('#post-img-container').style.display='none';document.querySelector('#post-image').value='';if(postContent.trim()==='')document.querySelector('#post-form-submit-btn').disabled=true;setPostFormImagePreview(null);};var onEmojiSelect=function onEmojiSelect(event,emojiObject){setPostContent(postContent+emojiObject.emoji);document.querySelector('#post-form-submit-btn').disabled=false;};var handleFormSubmit=function handleFormSubmit(e){e.preventDefault();fetch(\"\".concat(SERVER_URL,\"/post-api/create-post\"),{method:'POST',headers:{'Content-type':'application/json','X-CSRFToken':csrftoken},body:JSON.stringify({'post-content':postContent,'post-image':postImage})}).then(function(response){return response.json();}).then(function(data){console.log(data);props.fetchPosts();});};return/*#__PURE__*/React.createElement(\"div\",{className:\"create-post-form\",encType:\"multipart/form-data\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(Link,{to:\"/perfil\"},/*#__PURE__*/React.createElement(\"img\",{src:\"\".concat(SERVER_URL).concat(myProfile.photo),className:\"profile-img-med\"})),/*#__PURE__*/React.createElement(\"textarea\",{className:\"post-content-textarea\",value:postContent,placeholder:\"No que voc\\xEA est\\xE1 pensando?\",maxLength:300,autoFocus:true,onChange:handlePostContentChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"w-100 d-flex justify-content-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"post-img-container\",id:\"post-img-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"post-img-options\"},/*#__PURE__*/React.createElement(\"i\",{className:\"far fa-times-circle\",onClick:handleCloseImage})),/*#__PURE__*/React.createElement(\"img\",{src:postFormImagePreview,className:\"post-img post-form-img-preview\",id:\"post-form-img-preview\"}))),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-between\",style:{margin:'0px 70px 0 70px'}},/*#__PURE__*/React.createElement(\"div\",{className:\"post-extra-options\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"post-image\",class:\"far fa-image\"}),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",accept:\"image/png, image/jpg, image/jpeg\",id:\"post-image\",value:postImage,style:{display:'none'},onChange:handlePostImageChange}),/*#__PURE__*/React.createElement(\"label\",{className:\"far fa-smile\",id:\"emoji-button\",onClick:function onClick(){return openCloseEmojiList(false);}}),/*#__PURE__*/React.createElement(\"div\",{className:\"emoji-list-container\",id:\"emoji-list-container\"},/*#__PURE__*/React.createElement(Picker,{onEmojiClick:onEmojiSelect}))),/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary\",id:\"post-form-submit-btn\",disabled:true,onClick:handleFormSubmit,style:{height:'40px'}},\"Postar\")));}","map":{"version":3,"sources":["C:/Users/felip/CodeProjects/Web/Napker/frontend/src/pages/home/components/posts_/components/PostForm.js"],"names":["React","useState","Picker","Link","SERVER_URL","csrftoken","openCloseEmojiList","PostForm","props","myProfile","postContent","setPostContent","postImage","setPostImage","postFormImagePreview","setPostFormImagePreview","handlePostContentChange","e","target","value","el","document","querySelector","disabled","trim","handlePostImageChange","reader","FileReader","onload","readyState","result","style","display","readAsDataURL","files","handleCloseImage","onEmojiSelect","event","emojiObject","emoji","handleFormSubmit","preventDefault","fetch","method","headers","body","JSON","stringify","then","response","json","data","console","log","fetchPosts","photo","margin","height"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\r\nimport Picker from 'emoji-picker-react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport { SERVER_URL } from '../../../../../config/settings'\r\nimport { csrftoken, openCloseEmojiList } from '../../../../../config/utils'\r\n\r\nexport default function PostForm(props) {\r\n    const myProfile = props.myProfile\r\n\r\n    const [postContent, setPostContent] = useState('')\r\n    const [postImage, setPostImage] = useState(null)\r\n    const [postFormImagePreview, setPostFormImagePreview] = useState(null)\r\n\r\n    const handlePostContentChange = e => {\r\n        setPostContent(e.target.value)\r\n        const el = document.querySelector('#post-form-submit-btn')\r\n        el.disabled = e.target.value.trim() === '' && !postFormImagePreview\r\n    }\r\n\r\n    const handlePostImageChange = e => {\r\n        setPostImage(e.target.value)\r\n        const reader = new FileReader()\r\n        reader.onload = () => {\r\n            if (reader.readyState === 2) {\r\n                setPostFormImagePreview(reader.result)\r\n                document.querySelector('#post-img-container').style.display = 'initial'\r\n                document.querySelector('#post-form-submit-btn').disabled = false\r\n            }\r\n        }\r\n        try {\r\n            reader.readAsDataURL(e.target.files[0])\r\n        } catch {\r\n\r\n        }\r\n    }\r\n\r\n    const handleCloseImage = () => {\r\n        setPostImage(null)\r\n        document.querySelector('#post-img-container').style.display = 'none'\r\n        document.querySelector('#post-image').value = ''\r\n        if (postContent.trim() === '') document.querySelector('#post-form-submit-btn').disabled = true\r\n        setPostFormImagePreview(null)\r\n    }\r\n\r\n    const onEmojiSelect = (event, emojiObject) => {\r\n        setPostContent(postContent + emojiObject.emoji)\r\n        document.querySelector('#post-form-submit-btn').disabled = false\r\n    }\r\n\r\n    const handleFormSubmit = e => {\r\n        e.preventDefault()\r\n        fetch(`${SERVER_URL}/post-api/create-post`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-type': 'application/json',\r\n                'X-CSRFToken': csrftoken,\r\n            },\r\n            body: JSON.stringify({\r\n                'post-content': postContent,\r\n                'post-image': postImage,\r\n            })\r\n        })\r\n            .then(response => response.json())\r\n            .then(data => {\r\n                console.log(data)\r\n                props.fetchPosts()\r\n            })\r\n    }\r\n\r\n    return (\r\n        <div\r\n            className=\"create-post-form\"\r\n            encType=\"multipart/form-data\"\r\n        >\r\n            <div className=\"d-flex\">\r\n                <Link to=\"/perfil\">\r\n                    <img\r\n                        src={`${SERVER_URL}${myProfile.photo}`}\r\n                        className=\"profile-img-med\"\r\n                    />\r\n                </Link>\r\n                <textarea\r\n                    className=\"post-content-textarea\"\r\n                    value={postContent}\r\n                    placeholder=\"No que você está pensando?\"\r\n                    maxLength={300}\r\n                    autoFocus\r\n                    onChange={handlePostContentChange}\r\n                />\r\n            </div>\r\n            <div className=\"w-100 d-flex justify-content-center\">\r\n                <div\r\n                    className=\"post-img-container\"\r\n                    id=\"post-img-container\">\r\n                    <div\r\n                        className=\"post-img-options\"\r\n                    >\r\n                        <i\r\n                            className=\"far fa-times-circle\"\r\n                            onClick={handleCloseImage}\r\n                        />\r\n                    </div>\r\n                    <img\r\n                        src={postFormImagePreview}\r\n                        className=\"post-img post-form-img-preview\"\r\n                        id=\"post-form-img-preview\"\r\n                    />\r\n                </div>\r\n            </div>\r\n            <hr />\r\n            <div className=\"d-flex justify-content-between\" style={{ margin: '0px 70px 0 70px' }}>\r\n                <div className=\"post-extra-options\">\r\n                    <label htmlFor=\"post-image\" class=\"far fa-image\" />\r\n                    <input\r\n                        type=\"file\"\r\n                        accept=\"image/png, image/jpg, image/jpeg\"\r\n                        id=\"post-image\"\r\n                        value={postImage}\r\n                        style={{ display: 'none' }}\r\n                        onChange={handlePostImageChange}\r\n                    />\r\n                    <label\r\n                        className=\"far fa-smile\"\r\n                        id=\"emoji-button\"\r\n                        onClick={() => openCloseEmojiList(false)}\r\n                    />\r\n                    <div className=\"emoji-list-container\" id=\"emoji-list-container\">\r\n                        <Picker onEmojiClick={onEmojiSelect} />\r\n                    </div>\r\n                </div>\r\n                <button\r\n                    className=\"btn btn-primary\"\r\n                    id=\"post-form-submit-btn\"\r\n                    disabled\r\n                    onClick={handleFormSubmit}\r\n                    style={{ height: '40px' }}\r\n                >\r\n                    Postar\r\n                </button>\r\n            </div>\r\n        </div>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}