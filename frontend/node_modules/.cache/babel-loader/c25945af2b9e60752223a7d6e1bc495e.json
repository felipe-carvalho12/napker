{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\fabio\\\\CodeProjects\\\\Django\\\\napker\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\fabio\\\\CodeProjects\\\\Django\\\\napker\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\fabio\\\\CodeProjects\\\\Django\\\\napker\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\fabio\\\\CodeProjects\\\\Django\\\\napker\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import{Link}from'react-router-dom';import{SERVER_URL}from'../../config/settings';import{csrftoken}from'../../config/utils';import Header from'../../components/fixed/header';import Posts from'./components/Posts';import Interests from'./components/interests/Interests';import ProfileData from'./components/ProfileData';import BottomMenu from'../../components/fixed/bottom-menu/BottomMenu';var Profile=/*#__PURE__*/function(_React$Component){_inherits(Profile,_React$Component);var _super=_createSuper(Profile);function Profile(props){var _this;_classCallCheck(this,Profile);_this=_super.call(this,props);_this.fetchProfile=function(){fetch(\"\".concat(SERVER_URL,\"/profile-api/user/\").concat(_this.slug)).then(function(response){return response.json();}).then(function(data){return _this.setState({profile:data});});fetch(\"\".concat(SERVER_URL,\"/profile-api/myprofile\")).then(function(response){return response.json();}).then(function(data){return _this.setState({myProfile:data});});};_this.sendFriendRequest=function(pk){fetch(\"\".concat(SERVER_URL,\"/profile-api/send-friend-request\"),{method:'POST',headers:{'Content-type':'application/json','X-CSRFToken':csrftoken},body:JSON.stringify(pk)}).then(function(response){return response.json();}).then(function(data){return console.log(data);});};_this.cancelFriendRequest=function(pk){fetch(\"\".concat(SERVER_URL,\"/profile-api/cancel-friend-request\"),{method:'POST',headers:{'Content-type':'application/json','X-CSRFToken':csrftoken},body:JSON.stringify(pk)}).then(function(response){return response.json();}).then(function(data){return console.log(data);});};_this.removeFromFriends=function(pk){fetch(\"\".concat(SERVER_URL,\"/profile-api/remove-from-friends\"),{method:'POST',headers:{'Content-type':'application/json','X-CSRFToken':csrftoken},body:JSON.stringify(pk)}).then(function(response){return response.json();}).then(function(data){return console.log(data);});};_this.acceptFriendRequest=function(pk){fetch(\"\".concat(SERVER_URL,\"/profile-api/reply-friend-request\"),{method:'POST',headers:{'Content-type':'application/json','X-CSRFToken':csrftoken},body:JSON.stringify({'senderid':pk,'reply':'accept'})}).then(function(response){return response.json();}).then(function(data){console.log(data);_this.props.updateNotificationsNumber();});};_this.handleRelationshipUpdate=function(e){var btn=e.target;if(btn.innerHTML==='Solicitar'){_this.sendFriendRequest(btn.dataset.pk);btn.innerHTML='Solicitado';btn.className='btn btn-primary';}else if(btn.innerHTML==='Solicitado'){_this.cancelFriendRequest(btn.dataset.pk);btn.innerHTML='Solicitar';btn.className='btn btn-secondary';}else if(btn.innerHTML==='Amigos'||btn.innerHTML==='Remover'){if(window.confirm(\"Remover @\".concat(_this.state.profile.user.username,\" dos amigos?\"))){_this.removeFromFriends(btn.dataset.pk);btn.innerHTML='Solicitar';btn.className='btn btn-secondary';}}else if(btn.innerHTML==='Aceitar'){_this.acceptFriendRequest(btn.dataset.pk);btn.innerHTML='Amigos';btn.className='btn btn-primary';}};_this.blockUnblockUser=function(){if(_this.state.myProfile.blocked_users.map(function(u){return u.id;}).includes(_this.state.profile.user.id)){if(window.confirm(\"Tem certeza que deseja desbloquear \".concat(_this.state.profile.first_name,\" ?\"))){fetch(\"\".concat(SERVER_URL,\"/profile-api/unblock-user\"),{method:'POST',headers:{'Content-type':'application/json','X-CSRFToken':csrftoken},body:JSON.stringify(_this.state.profile)}).then(function(response){return response.json();}).then(function(data){console.log(data);_this.setState({alertMessage:\"Voc\\xEA desbloqueou @\".concat(_this.state.profile.user.username,\".\")});_this.fetchProfile();});}}else{if(window.confirm(\"Tem certeza que deseja bloquear \".concat(_this.state.profile.first_name,\" ?\"))){fetch(\"\".concat(SERVER_URL,\"/profile-api/block-user\"),{method:'POST',headers:{'Content-type':'application/json','X-CSRFToken':csrftoken},body:JSON.stringify(_this.state.profile)}).then(function(response){return response.json();}).then(function(data){console.log(data);_this.setState({alertMessage:\"Voc\\xEA bloqueou @\".concat(_this.state.profile.user.username,\".\\n                         \").concat(_this.state.profile.first_name,\" n\\xE3o conseguir\\xE1 mais ver o seu perfil ou te enviar mensagens.\")});_this.fetchProfile();});}}_this.fetchProfile();document.querySelector('#view-more-select').style.display='none';};_this.openCloseExtraOptions=function(){var el=document.querySelector('#view-more-select');var style=el.style;if(!style.display)style.display='none';if(style.display==='none'){document.querySelector('#view-more-icon').classList.add('view-more-icon-active');style.display='flex';}else{document.querySelector('#view-more-icon').classList.remove('view-more-icon-active');style.display='none';}};_this.switchPage=function(e){document.querySelectorAll('.profile-page-menu-item-active').forEach(function(el){el.classList.remove('profile-page-menu-item-active');});e.target.classList.add('profile-page-menu-item-active');if(e.target.id==='profile-posts-page-menu-item'){_this.setState({currentPageIsPosts:true});}else if(e.target.id==='profile-interests-page-menu-item'){_this.setState({currentPageIsPosts:false});}};_this.state={myProfile:null,profile:null,alertMessage:null,relationshipButtonLabel:'',currentPageIsPosts:true};_this.slug=_this.props.match.params.slug;return _this;}_createClass(Profile,[{key:\"componentWillMount\",value:function componentWillMount(){this.fetchProfile();}},{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch(\"\".concat(SERVER_URL,\"/profile-api/relationship/\").concat(this.slug)).then(function(response){return response.json();}).then(function(data){var label;switch(data.relationship){case'friends':label='Amigos';break;case'invite-sent':label='Solicitado';break;case'invite-received':label='Aceitar';break;case'none':label='Solicitar';}_this2.setState({relationshipButtonLabel:label});});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){var btn=document.querySelector('#profile-page-relationship-btn');if(btn){switch(btn.innerHTML){case'Amigos':btn.classList.add('btn-primary');btn.onmouseenter=function(){if(btn.innerHTML==='Amigos')btn.innerHTML='Remover';};btn.onmouseout=function(){if(btn.innerHTML==='Remover')btn.innerHTML='Amigos';};btn.classList.add('friend-btn');btn.classList.remove('d-none');break;case'Solicitado':btn.classList.add('btn-primary');btn.classList.remove('d-none');break;case'Aceitar':btn.classList.add('btn-primary');btn.classList.remove('d-none');break;case'Solicitar':btn.classList.add('btn-secondary');btn.classList.remove('d-none');}}}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Header,{page:this.state.profile?\"\".concat(this.state.profile.first_name,\" \").concat(this.state.profile.last_name):'Perfil',backArrow:true}),this.state.myProfile!==null&&this.state.profile!==null?/*#__PURE__*/React.createElement(\"div\",{className:\"content\"},this.state.profile.blocked_users.map(function(u){return u.id;}).includes(this.state.myProfile.user.id)?/*#__PURE__*/React.createElement(\"div\",{className:\"user-blocked-me-container\"},/*#__PURE__*/React.createElement(\"h3\",null,\"O usu\\xE1rio te bloqueou\")):/*#__PURE__*/React.createElement(React.Fragment,null,this.state.alertMessage&&/*#__PURE__*/React.createElement(\"div\",{class:\"alert alert-success profile-page-alert-success\",role:\"alert\"},this.state.alertMessage),/*#__PURE__*/React.createElement(ProfileData,{profile:this.state.profile},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-btn-wrapper\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-ellipsis-h btn btn-secondary mr-2\",id:\"view-more-icon\",onClick:this.openCloseExtraOptions}),/*#__PURE__*/React.createElement(\"div\",{className:\"view-more-select profile-view-more-select\",id:\"view-more-select\"},/*#__PURE__*/React.createElement(Link,{to:\"/mensagens/\".concat(this.state.profile.slug),style:{color:'#000',textDecoration:'none'}},!this.state.myProfile.blocked_users.map(function(u){return u.id;}).includes(this.state.profile.user.id)&&/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"i\",{class:\"fas fa-envelope text-secondary\"}),\"Enviar mensagem\")),/*#__PURE__*/React.createElement(\"li\",{onClick:this.blockUnblockUser},/*#__PURE__*/React.createElement(\"i\",{class:\"fas fa-user-lock text-secondary\"}),this.state.myProfile.blocked_users.map(function(u){return u.id;}).includes(this.state.profile.user.id)?'Desbloquear':'Bloquear')),!this.state.myProfile.blocked_users.map(function(u){return u.id;}).includes(this.state.profile.user.id)&&/*#__PURE__*/React.createElement(\"button\",{className:\"btn d-none\",id:\"profile-page-relationship-btn\",\"data-pk\":this.state.profile.id,onClick:this.handleRelationshipUpdate},this.state.relationshipButtonLabel))),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-page-menu\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-page-menu-item profile-page-menu-item-active\",id:\"profile-posts-page-menu-item\",onClick:this.switchPage},\"Posts (\",this.state.profile.posts.length,\")\"),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-page-menu-item\",id:\"profile-interests-page-menu-item\",onClick:this.switchPage},\"Interesses (\",this.state.profile.interests.filter(function(i){return i.public;}).length,\")\")),this.state.currentPageIsPosts?/*#__PURE__*/React.createElement(Posts,{profile:this.state.profile,fetchProfile:this.fetchProfile}):/*#__PURE__*/React.createElement(Interests,{profile:this.state.profile}))):/*#__PURE__*/React.createElement(\"div\",{className:\"profile-page-loader-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"loader\"})),/*#__PURE__*/React.createElement(BottomMenu,null));}}]);return Profile;}(React.Component);export default Profile;","map":{"version":3,"sources":["C:/Users/fabio/CodeProjects/Django/napker/frontend/src/pages/profile/Profile.js"],"names":["React","Link","SERVER_URL","csrftoken","Header","Posts","Interests","ProfileData","BottomMenu","Profile","props","fetchProfile","fetch","slug","then","response","json","data","setState","profile","myProfile","sendFriendRequest","pk","method","headers","body","JSON","stringify","console","log","cancelFriendRequest","removeFromFriends","acceptFriendRequest","updateNotificationsNumber","handleRelationshipUpdate","e","btn","target","innerHTML","dataset","className","window","confirm","state","user","username","blockUnblockUser","blocked_users","map","u","id","includes","first_name","alertMessage","document","querySelector","style","display","openCloseExtraOptions","el","classList","add","remove","switchPage","querySelectorAll","forEach","currentPageIsPosts","relationshipButtonLabel","match","params","label","relationship","onmouseenter","onmouseout","last_name","color","textDecoration","posts","length","interests","filter","i","public","Component"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport { SERVER_URL } from '../../config/settings'\r\nimport { csrftoken } from '../../config/utils'\r\nimport Header from '../../components/fixed/header'\r\nimport Posts from './components/Posts'\r\nimport Interests from './components/interests/Interests'\r\nimport ProfileData from './components/ProfileData'\r\nimport BottomMenu from '../../components/fixed/bottom-menu/BottomMenu'\r\n\r\nclass Profile extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            myProfile: null,\r\n            profile: null,\r\n            alertMessage: null,\r\n            relationshipButtonLabel: '',\r\n            currentPageIsPosts: true,\r\n        }\r\n        this.slug = this.props.match.params.slug\r\n    }\r\n\r\n    componentWillMount() {\r\n        this.fetchProfile()\r\n    }\r\n\r\n    componentDidMount() {\r\n        fetch(`${SERVER_URL}/profile-api/relationship/${this.slug}`)\r\n            .then(response => response.json())\r\n            .then(data => {\r\n                let label\r\n                switch (data.relationship) {\r\n                    case 'friends':\r\n                        label = 'Amigos'\r\n                        break\r\n                    case 'invite-sent':\r\n                        label = 'Solicitado'\r\n                        break\r\n                    case 'invite-received':\r\n                        label = 'Aceitar'\r\n                        break\r\n                    case 'none':\r\n                        label = 'Solicitar'\r\n                }\r\n                this.setState({\r\n                    relationshipButtonLabel: label\r\n                })\r\n            })\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        let btn = document.querySelector('#profile-page-relationship-btn')\r\n        if (btn) {\r\n            switch (btn.innerHTML) {\r\n                case 'Amigos':\r\n                    btn.classList.add('btn-primary')\r\n                    btn.onmouseenter = () => {\r\n                        if (btn.innerHTML === 'Amigos') btn.innerHTML = 'Remover'\r\n                    }\r\n                    btn.onmouseout = () => {\r\n                        if (btn.innerHTML === 'Remover') btn.innerHTML = 'Amigos'\r\n                    }\r\n                    btn.classList.add('friend-btn')\r\n                    btn.classList.remove('d-none')\r\n                    break\r\n                case 'Solicitado':\r\n                    btn.classList.add('btn-primary')\r\n                    btn.classList.remove('d-none')\r\n                    break\r\n                case 'Aceitar':\r\n                    btn.classList.add('btn-primary')\r\n                    btn.classList.remove('d-none')\r\n                    break\r\n                case 'Solicitar':\r\n                    btn.classList.add('btn-secondary')\r\n                    btn.classList.remove('d-none')\r\n            }\r\n        }\r\n    }\r\n\r\n    fetchProfile = () => {\r\n        fetch(`${SERVER_URL}/profile-api/user/${this.slug}`)\r\n            .then(response => response.json())\r\n            .then(data => this.setState({\r\n                profile: data\r\n            }))\r\n        fetch(`${SERVER_URL}/profile-api/myprofile`)\r\n            .then(response => response.json())\r\n            .then(data => this.setState({ myProfile: data }))\r\n    }\r\n\r\n    sendFriendRequest = pk => {\r\n        fetch(`${SERVER_URL}/profile-api/send-friend-request`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-type': 'application/json',\r\n                'X-CSRFToken': csrftoken,\r\n            },\r\n            body: JSON.stringify(pk)\r\n        })\r\n            .then(response => response.json())\r\n            .then(data => console.log(data))\r\n    }\r\n\r\n    cancelFriendRequest = pk => {\r\n        fetch(`${SERVER_URL}/profile-api/cancel-friend-request`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-type': 'application/json',\r\n                'X-CSRFToken': csrftoken,\r\n            },\r\n            body: JSON.stringify(pk)\r\n        })\r\n            .then(response => response.json())\r\n            .then(data => console.log(data))\r\n    }\r\n\r\n    removeFromFriends = pk => {\r\n        fetch(`${SERVER_URL}/profile-api/remove-from-friends`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-type': 'application/json',\r\n                'X-CSRFToken': csrftoken,\r\n            },\r\n            body: JSON.stringify(pk)\r\n        })\r\n            .then(response => response.json())\r\n            .then(data => console.log(data))\r\n    }\r\n\r\n    acceptFriendRequest = pk => {\r\n        fetch(`${SERVER_URL}/profile-api/reply-friend-request`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-type': 'application/json',\r\n                'X-CSRFToken': csrftoken,\r\n            },\r\n            body: JSON.stringify({\r\n                'senderid': pk,\r\n                'reply': 'accept'\r\n            })\r\n        })\r\n            .then(response => response.json())\r\n            .then(data => {\r\n                console.log(data)\r\n                this.props.updateNotificationsNumber()\r\n            })\r\n    }\r\n\r\n    handleRelationshipUpdate = e => {\r\n        const btn = e.target\r\n        if (btn.innerHTML === 'Solicitar') {\r\n            this.sendFriendRequest(btn.dataset.pk)\r\n            btn.innerHTML = 'Solicitado'\r\n            btn.className = 'btn btn-primary'\r\n        } else if (btn.innerHTML === 'Solicitado') {\r\n            this.cancelFriendRequest(btn.dataset.pk)\r\n            btn.innerHTML = 'Solicitar'\r\n            btn.className = 'btn btn-secondary'\r\n        } else if (btn.innerHTML === 'Amigos' || btn.innerHTML === 'Remover') {\r\n            if (window.confirm(`Remover @${this.state.profile.user.username} dos amigos?`)) {\r\n                this.removeFromFriends(btn.dataset.pk)\r\n                btn.innerHTML = 'Solicitar'\r\n                btn.className = 'btn btn-secondary'\r\n            }\r\n        } else if (btn.innerHTML === 'Aceitar') {\r\n            this.acceptFriendRequest(btn.dataset.pk)\r\n            btn.innerHTML = 'Amigos'\r\n            btn.className = 'btn btn-primary'\r\n        }\r\n    }\r\n\r\n    blockUnblockUser = () => {\r\n        if (this.state.myProfile.blocked_users.map(u => u.id).includes(this.state.profile.user.id)) {\r\n            if (window.confirm(`Tem certeza que deseja desbloquear ${this.state.profile.first_name} ?`)) {\r\n                fetch(`${SERVER_URL}/profile-api/unblock-user`, {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-type': 'application/json',\r\n                        'X-CSRFToken': csrftoken,\r\n                    },\r\n                    body: JSON.stringify(this.state.profile)\r\n                })\r\n                    .then(response => response.json())\r\n                    .then(data => {\r\n                        console.log(data)\r\n                        this.setState({ alertMessage: `Você desbloqueou @${this.state.profile.user.username}.` })\r\n                        this.fetchProfile()\r\n                    })\r\n            }\r\n        } else {\r\n            if (window.confirm(`Tem certeza que deseja bloquear ${this.state.profile.first_name} ?`)) {\r\n                fetch(`${SERVER_URL}/profile-api/block-user`, {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-type': 'application/json',\r\n                        'X-CSRFToken': csrftoken,\r\n                    },\r\n                    body: JSON.stringify(this.state.profile)\r\n                })\r\n                    .then(response => response.json())\r\n                    .then(data => {\r\n                        console.log(data)\r\n                        this.setState({\r\n                            alertMessage: `Você bloqueou @${this.state.profile.user.username}.\r\n                         ${this.state.profile.first_name} não conseguirá mais ver o seu perfil ou te enviar mensagens.`\r\n                        })\r\n                        this.fetchProfile()\r\n                    })\r\n            }\r\n        }\r\n        this.fetchProfile()\r\n        document.querySelector('#view-more-select').style.display = 'none'\r\n    }\r\n\r\n    openCloseExtraOptions = () => {\r\n        const el = document.querySelector('#view-more-select')\r\n        const style = el.style\r\n        if (!style.display) style.display = 'none'\r\n        if (style.display === 'none') {\r\n            document.querySelector('#view-more-icon').classList.add('view-more-icon-active')\r\n            style.display = 'flex'\r\n        } else {\r\n            document.querySelector('#view-more-icon').classList.remove('view-more-icon-active')\r\n            style.display = 'none'\r\n        }\r\n    }\r\n\r\n    switchPage = e => {\r\n        document.querySelectorAll('.profile-page-menu-item-active').forEach(el => {\r\n            el.classList.remove('profile-page-menu-item-active')\r\n        })\r\n        e.target.classList.add('profile-page-menu-item-active')\r\n        if (e.target.id === 'profile-posts-page-menu-item') {\r\n            this.setState({ currentPageIsPosts: true })\r\n        } else if (e.target.id === 'profile-interests-page-menu-item') {\r\n            this.setState({ currentPageIsPosts: false })\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                <Header page={this.state.profile ? `${this.state.profile.first_name} ${this.state.profile.last_name}` : 'Perfil'}\r\n                    backArrow={true}\r\n                />\r\n                {this.state.myProfile !== null && this.state.profile !== null ?\r\n                    <div className=\"content\">\r\n                        {this.state.profile.blocked_users.map(u => u.id).includes(this.state.myProfile.user.id) ?\r\n                            <div className=\"user-blocked-me-container\">\r\n                                <h3>O usuário te bloqueou</h3>\r\n                            </div>\r\n                            :\r\n                            <>\r\n                                {this.state.alertMessage &&\r\n                                    <div class=\"alert alert-success profile-page-alert-success\" role=\"alert\">\r\n                                        {this.state.alertMessage}\r\n                                    </div>\r\n                                }\r\n                                <ProfileData profile={this.state.profile}>\r\n                                    <div className=\"profile-btn-wrapper\">\r\n                                        <i\r\n                                            className=\"fas fa-ellipsis-h btn btn-secondary mr-2\"\r\n                                            id=\"view-more-icon\"\r\n                                            onClick={this.openCloseExtraOptions}\r\n                                        />\r\n                                        <div className=\"view-more-select profile-view-more-select\" id=\"view-more-select\">\r\n                                            <Link to={`/mensagens/${this.state.profile.slug}`} style={{ color: '#000', textDecoration: 'none' }}>\r\n                                                {!this.state.myProfile.blocked_users.map(u => u.id).includes(this.state.profile.user.id) &&\r\n                                                    <li>\r\n                                                        <i class=\"fas fa-envelope text-secondary\" />\r\n                                                        Enviar mensagem\r\n                                                    </li>\r\n                                                }\r\n                                            </Link>\r\n                                            <li onClick={this.blockUnblockUser}>\r\n                                                <i class=\"fas fa-user-lock text-secondary\" />\r\n                                                {this.state.myProfile.blocked_users.map(u => u.id).includes(this.state.profile.user.id) ?\r\n                                                    'Desbloquear'\r\n                                                    :\r\n                                                    'Bloquear'\r\n                                                }\r\n                                            </li>\r\n                                        </div>\r\n                                        {!this.state.myProfile.blocked_users.map(u => u.id).includes(this.state.profile.user.id) &&\r\n                                            <button className=\"btn d-none\"\r\n                                                id=\"profile-page-relationship-btn\"\r\n                                                data-pk={this.state.profile.id}\r\n                                                onClick={this.handleRelationshipUpdate}\r\n                                            >{this.state.relationshipButtonLabel}</button>\r\n                                        }\r\n                                    </div>\r\n                                </ProfileData>\r\n                                <div className=\"profile-page-menu\">\r\n                                    <div\r\n                                        className=\"profile-page-menu-item profile-page-menu-item-active\"\r\n                                        id=\"profile-posts-page-menu-item\"\r\n                                        onClick={this.switchPage}\r\n                                    >\r\n                                        Posts ({this.state.profile.posts.length})\r\n                                    </div>\r\n                                    <div\r\n                                        className=\"profile-page-menu-item\"\r\n                                        id=\"profile-interests-page-menu-item\"\r\n                                        onClick={this.switchPage}\r\n                                    >\r\n                                        Interesses ({this.state.profile.interests.filter(i => i.public).length})\r\n                                    </div>\r\n                                </div>\r\n                                {this.state.currentPageIsPosts ?\r\n                                    <Posts profile={this.state.profile} fetchProfile={this.fetchProfile} /> :\r\n                                    <Interests profile={this.state.profile} />\r\n                                }\r\n                            </>\r\n                        }\r\n                    </div>\r\n                    :\r\n                    <div className=\"profile-page-loader-container\">\r\n                        <div className=\"loader\" />\r\n                    </div>\r\n                }\r\n                <BottomMenu />\r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Profile"]},"metadata":{},"sourceType":"module"}