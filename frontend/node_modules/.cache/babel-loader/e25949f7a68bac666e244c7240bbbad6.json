{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\felip\\\\CodeProjects\\\\Django\\\\Napker\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{Link,useParams}from'react-router-dom';import CommentModal from'../../components/commentmodal';import LikesModal from'../../components/likesmodal';import Header from'../../components/main/header';import{SERVER_URL}from'../../settings';import{csrftoken}from'../../utils';export default function Post(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),profile=_useState4[0],setProfile=_useState4[1];var _useState5=useState(props.commentModalIsOpen),_useState6=_slicedToArray(_useState5,2),commentModalIsOpen=_useState6[0],setCommentModalIsOpen=_useState6[1];var _useState7=useState({isOpen:false,likes:null}),_useState8=_slicedToArray(_useState7,2),postLikesModal=_useState8[0],setPostLikesModal=_useState8[1];var _useState9=useState({isOpen:false,likes:null}),_useState10=_slicedToArray(_useState9,2),commentLikesModal=_useState10[0],setCommentLikesModal=_useState10[1];var _useParams=useParams(),id=_useParams.id;useEffect(function(){fetchPost();fetch(\"\".concat(SERVER_URL,\"/profile-api/myprofile\")).then(function(response){return response.json();}).then(function(data){return setProfile(data);});},[]);var fetchPost=function fetchPost(){fetch(\"\".concat(SERVER_URL,\"/post-api/post/\").concat(id)).then(function(response){return response.json();}).then(function(data){return setPost(data);});};var likeUnlikePost=function likeUnlikePost(e){var likeBtn=e.target;if(likeBtn.classList.contains('fas')){likeBtn.classList.remove('fas');//border heart\nlikeBtn.classList.add('far');//filled heart\nfetch(\"\".concat(SERVER_URL,\"/post-api/unlike-post/\").concat(likeBtn.dataset.postid)).then(function(response){return response.json();}).then(function(data){console.log(data);fetchPost();});}else{likeBtn.classList.remove('far');//border heart\nlikeBtn.classList.add('fas');//filled heart\nfetch(\"\".concat(SERVER_URL,\"/post-api/like-post/\").concat(likeBtn.dataset.postid)).then(function(response){return response.json();}).then(function(data){console.log(data);fetchPost();});}};var likeUnlikeComment=function likeUnlikeComment(e){var likeBtn=e.target;if(likeBtn.classList.contains('fas')){likeBtn.classList.remove('fas');//border heart\nlikeBtn.classList.add('far');//filled heart\nfetch(\"\".concat(SERVER_URL,\"/post-api/unlike-comment/\").concat(likeBtn.dataset.commentid)).then(function(response){return response.json();}).then(function(data){console.log(data);fetchPost();});}else{likeBtn.classList.remove('far');//border heart\nlikeBtn.classList.add('fas');//filled heart\nfetch(\"\".concat(SERVER_URL,\"/post-api/like-comment/\").concat(likeBtn.dataset.commentid)).then(function(response){return response.json();}).then(function(data){console.log(data);fetchPost();});}};var deleteComment=function deleteComment(e,commentId){e.stopPropagation();var el=document.querySelector(\"#post-comment-\".concat(commentId));if(window.confirm('Tem certeza que deseja apagar o comentário?\\nEssa ação é irreversível.')){el.style.animationPlayState='running';console.log(el,el.style.animationPlayState);el.addEventListener('animationend',function(){fetchPost();});fetch(\"\".concat(SERVER_URL,\"/post-api/delete-comment/\").concat(commentId),{method:'POST',headers:{'Content-type':'application/json','X-CSRFToken':csrftoken}}).then(function(response){return response.json();}).then(function(data){console.log(data);});}};var deletePost=function deletePost(e,postId){e.stopPropagation();var el=document.querySelector(\"#profile-post-\".concat(postId));if(window.confirm('Tem certeza que deseja apagar o post?\\nEssa ação é irreversível.')){fetch(\"\".concat(SERVER_URL,\"/post-api/delete-post/\").concat(postId),{method:'POST',headers:{'Content-type':'application/json','X-CSRFToken':csrftoken}}).then(function(response){return response.json();}).then(function(data){console.log(data);window.location.href='/';});}};var hideCommentModal=function hideCommentModal(){setCommentModalIsOpen(false);};var hidePostLikesModal=function hidePostLikesModal(){setPostLikesModal({isOpen:false,likes:null});};var hideCommentLikesModal=function hideCommentLikesModal(){setCommentLikesModal({isOpen:false,likes:null});};return/*#__PURE__*/React.createElement(\"div\",{className:\"post-page-container\"},post&&/*#__PURE__*/React.createElement(CommentModal,{isOpen:commentModalIsOpen,hideModal:hideCommentModal,post:post}),/*#__PURE__*/React.createElement(LikesModal,{isOpen:postLikesModal.isOpen,likes:postLikesModal.likes,hideModal:hidePostLikesModal}),/*#__PURE__*/React.createElement(LikesModal,{isOpen:commentLikesModal.isOpen,likes:commentLikesModal.likes,hideModal:hideCommentLikesModal}),/*#__PURE__*/React.createElement(Header,{page:\"Post\",backArrow:true}),/*#__PURE__*/React.createElement(\"div\",{className:\"content\"},post&&profile?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"post-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-between\"},/*#__PURE__*/React.createElement(\"div\",{className:\"post-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"post-col\"},/*#__PURE__*/React.createElement(Link,{to:\"/user/\".concat(post.author.slug)},/*#__PURE__*/React.createElement(\"img\",{src:\"\".concat(SERVER_URL).concat(post.author.photo),className:\"profile-img-med\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"post-col\"},/*#__PURE__*/React.createElement(Link,{to:\"/user/\".concat(post.author.slug),style:{color:'#000'}},/*#__PURE__*/React.createElement(\"div\",{style:{height:'30px'}},/*#__PURE__*/React.createElement(\"strong\",null,post.author.first_name,\" \",post.author.last_name,\" \"),/*#__PURE__*/React.createElement(\"p\",{className:\"text-secondary d-inline-block\"},\"@\",post.author.user.username,\" \\u2022 \",post.created.split('-').reverse().join('/')))),/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:'start',fontSize:'larger'}},post.content),post.image&&/*#__PURE__*/React.createElement(\"img\",{src:\"\".concat(SERVER_URL).concat(post.image),className:\"post-img\"}))),profile.id==post.author.id&&/*#__PURE__*/React.createElement(\"i\",{className:\"far fa-trash-alt trash-icon text-secondary\",style:{margin:'20px 20px 0 0'},onClick:function onClick(e){return deletePost(e,post.id);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"post-actions\"},/*#__PURE__*/React.createElement(\"p\",{className:\"text-secondary\",style:{fontSize:'large'}},/*#__PURE__*/React.createElement(Link,{to:\"/post/\".concat(id,\"/comentar\"),className:\"text-secondary\"},/*#__PURE__*/React.createElement(\"i\",{class:\"far fa-comment\",onClick:function onClick(){return setCommentModalIsOpen(true);}})),post.comments.length,post.likes.map(function(like){return like.profile.id;}).includes(profile.id)?/*#__PURE__*/React.createElement(\"i\",{class:\"fas fa-heart\",\"data-postid\":post.id,onClick:likeUnlikePost}):/*#__PURE__*/React.createElement(\"i\",{class:\"far fa-heart\",\"data-postid\":post.id,onClick:likeUnlikePost}),/*#__PURE__*/React.createElement(\"p\",{className:\"post-likes-number\",onClick:function onClick(){return setPostLikesModal({isOpen:true,likes:post.likes});}},post.likes.length)))),/*#__PURE__*/React.createElement(\"div\",{className:\"comment-list\"},post.comments.map(function(comment){return/*#__PURE__*/React.createElement(\"li\",{className:\"post-container\",id:\"post-comment-\".concat(comment.id),key:comment.id},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-between\"},/*#__PURE__*/React.createElement(\"div\",{className:\"post-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"post-col\"},/*#__PURE__*/React.createElement(Link,{to:\"/user/\".concat(comment.author.slug)},/*#__PURE__*/React.createElement(\"img\",{src:\"\".concat(SERVER_URL).concat(comment.author.photo),className:\"profile-img-sm\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"post-col\"},/*#__PURE__*/React.createElement(Link,{to:\"/user/\".concat(comment.author.slug),style:{color:'#000'}},/*#__PURE__*/React.createElement(\"div\",{style:{height:'30px'}},/*#__PURE__*/React.createElement(\"strong\",null,comment.author.first_name,\" \",comment.author.last_name,\" \"),/*#__PURE__*/React.createElement(\"p\",{className:\"text-secondary d-inline-block\"},\"@\",comment.author.user.username,\" \\u2022 \",comment.created.split('-').reverse().join('/')))),/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:'start'}},comment.content))),comment.author.id==profile.id&&/*#__PURE__*/React.createElement(\"i\",{className:\"far fa-trash-alt trash-icon text-secondary\",style:{margin:'20px 20px 0 0'},onClick:function onClick(e){return deleteComment(e,comment.id);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"post-actions\"},/*#__PURE__*/React.createElement(\"p\",{className:\"text-secondary\"},comment.likes.map(function(like){return like.profile.id;}).includes(profile.id)?/*#__PURE__*/React.createElement(\"i\",{class:\"fas fa-heart\",\"data-commentid\":comment.id,onClick:likeUnlikeComment}):/*#__PURE__*/React.createElement(\"i\",{class:\"far fa-heart\",\"data-commentid\":comment.id,onClick:likeUnlikeComment}),/*#__PURE__*/React.createElement(\"p\",{className:\"post-likes-number\",onClick:function onClick(){return setPostLikesModal({isOpen:true,likes:comment.likes});}},comment.likes.length))));}))):/*#__PURE__*/React.createElement(\"div\",{className:\"posts-loader-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"loader\"}))));}","map":{"version":3,"sources":["C:/Users/felip/CodeProjects/Django/Napker/frontend/src/pages/home-components/post.js"],"names":["React","useEffect","useState","Link","useParams","CommentModal","LikesModal","Header","SERVER_URL","csrftoken","Post","props","post","setPost","profile","setProfile","commentModalIsOpen","setCommentModalIsOpen","isOpen","likes","postLikesModal","setPostLikesModal","commentLikesModal","setCommentLikesModal","id","fetchPost","fetch","then","response","json","data","likeUnlikePost","e","likeBtn","target","classList","contains","remove","add","dataset","postid","console","log","likeUnlikeComment","commentid","deleteComment","commentId","stopPropagation","el","document","querySelector","window","confirm","style","animationPlayState","addEventListener","method","headers","deletePost","postId","location","href","hideCommentModal","hidePostLikesModal","hideCommentLikesModal","author","slug","photo","color","height","first_name","last_name","user","username","created","split","reverse","join","textAlign","fontSize","content","image","margin","comments","length","map","like","includes","comment"],"mappings":"oLAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,IAAT,CAAeC,SAAf,KAAgC,kBAAhC,CAEA,MAAOC,CAAAA,YAAP,KAAyB,+BAAzB,CACA,MAAOC,CAAAA,UAAP,KAAuB,6BAAvB,CACA,MAAOC,CAAAA,MAAP,KAAmB,8BAAnB,CACA,OAASC,UAAT,KAA2B,gBAA3B,CACA,OAASC,SAAT,KAA0B,aAA1B,CAEA,cAAe,SAASC,CAAAA,IAAT,CAAcC,KAAd,CAAqB,eACRT,QAAQ,CAAC,IAAD,CADA,wCACzBU,IADyB,eACnBC,OADmB,8BAEFX,QAAQ,CAAC,IAAD,CAFN,yCAEzBY,OAFyB,eAEhBC,UAFgB,8BAGoBb,QAAQ,CAACS,KAAK,CAACK,kBAAP,CAH5B,yCAGzBA,kBAHyB,eAGLC,qBAHK,8BAIYf,QAAQ,CAAC,CAAEgB,MAAM,CAAE,KAAV,CAAiBC,KAAK,CAAE,IAAxB,CAAD,CAJpB,yCAIzBC,cAJyB,eAITC,iBAJS,8BAKkBnB,QAAQ,CAAC,CAAEgB,MAAM,CAAE,KAAV,CAAiBC,KAAK,CAAE,IAAxB,CAAD,CAL1B,0CAKzBG,iBALyB,gBAKNC,oBALM,+BAOjBnB,SAAS,EAPQ,CAOxBoB,EAPwB,YAOxBA,EAPwB,CAShCvB,SAAS,CAAC,UAAM,CACZwB,SAAS,GACTC,KAAK,WAAIlB,UAAJ,2BAAL,CACKmB,IADL,CACU,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EADlB,EAEKF,IAFL,CAEU,SAAAG,IAAI,QAAIf,CAAAA,UAAU,CAACe,IAAD,CAAd,EAFd,EAGH,CALQ,CAKN,EALM,CAAT,CAOA,GAAML,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACpBC,KAAK,WAAIlB,UAAJ,2BAAgCgB,EAAhC,EAAL,CACKG,IADL,CACU,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EADlB,EAEKF,IAFL,CAEU,SAAAG,IAAI,QAAIjB,CAAAA,OAAO,CAACiB,IAAD,CAAX,EAFd,EAGH,CAJD,CAMA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAAAC,CAAC,CAAI,CACxB,GAAMC,CAAAA,OAAO,CAAGD,CAAC,CAACE,MAAlB,CACA,GAAID,OAAO,CAACE,SAAR,CAAkBC,QAAlB,CAA2B,KAA3B,CAAJ,CAAuC,CACnCH,OAAO,CAACE,SAAR,CAAkBE,MAAlB,CAAyB,KAAzB,EAAgC;AAChCJ,OAAO,CAACE,SAAR,CAAkBG,GAAlB,CAAsB,KAAtB,EAA8B;AAC9BZ,KAAK,WAAIlB,UAAJ,kCAAuCyB,OAAO,CAACM,OAAR,CAAgBC,MAAvD,EAAL,CACKb,IADL,CACU,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EADlB,EAEKF,IAFL,CAEU,SAAAG,IAAI,CAAI,CACVW,OAAO,CAACC,GAAR,CAAYZ,IAAZ,EACAL,SAAS,GACZ,CALL,EAMH,CATD,IASO,CACHQ,OAAO,CAACE,SAAR,CAAkBE,MAAlB,CAAyB,KAAzB,EAAgC;AAChCJ,OAAO,CAACE,SAAR,CAAkBG,GAAlB,CAAsB,KAAtB,EAA8B;AAC9BZ,KAAK,WAAIlB,UAAJ,gCAAqCyB,OAAO,CAACM,OAAR,CAAgBC,MAArD,EAAL,CACKb,IADL,CACU,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EADlB,EAEKF,IAFL,CAEU,SAAAG,IAAI,CAAI,CACVW,OAAO,CAACC,GAAR,CAAYZ,IAAZ,EACAL,SAAS,GACZ,CALL,EAMH,CACJ,CArBD,CAuBA,GAAMkB,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAAAX,CAAC,CAAI,CAC3B,GAAMC,CAAAA,OAAO,CAAGD,CAAC,CAACE,MAAlB,CACA,GAAID,OAAO,CAACE,SAAR,CAAkBC,QAAlB,CAA2B,KAA3B,CAAJ,CAAuC,CACnCH,OAAO,CAACE,SAAR,CAAkBE,MAAlB,CAAyB,KAAzB,EAAgC;AAChCJ,OAAO,CAACE,SAAR,CAAkBG,GAAlB,CAAsB,KAAtB,EAA8B;AAC9BZ,KAAK,WAAIlB,UAAJ,qCAA0CyB,OAAO,CAACM,OAAR,CAAgBK,SAA1D,EAAL,CACKjB,IADL,CACU,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EADlB,EAEKF,IAFL,CAEU,SAAAG,IAAI,CAAI,CACVW,OAAO,CAACC,GAAR,CAAYZ,IAAZ,EACAL,SAAS,GACZ,CALL,EAMH,CATD,IASO,CACHQ,OAAO,CAACE,SAAR,CAAkBE,MAAlB,CAAyB,KAAzB,EAAgC;AAChCJ,OAAO,CAACE,SAAR,CAAkBG,GAAlB,CAAsB,KAAtB,EAA8B;AAC9BZ,KAAK,WAAIlB,UAAJ,mCAAwCyB,OAAO,CAACM,OAAR,CAAgBK,SAAxD,EAAL,CACKjB,IADL,CACU,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EADlB,EAEKF,IAFL,CAEU,SAAAG,IAAI,CAAI,CACVW,OAAO,CAACC,GAAR,CAAYZ,IAAZ,EACAL,SAAS,GACZ,CALL,EAMH,CACJ,CArBD,CAuBA,GAAMoB,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACb,CAAD,CAAIc,SAAJ,CAAkB,CACpCd,CAAC,CAACe,eAAF,GACA,GAAMC,CAAAA,EAAE,CAAGC,QAAQ,CAACC,aAAT,yBAAwCJ,SAAxC,EAAX,CACA,GAAIK,MAAM,CAACC,OAAP,CAAe,wEAAf,CAAJ,CAA8F,CAC1FJ,EAAE,CAACK,KAAH,CAASC,kBAAT,CAA8B,SAA9B,CACAb,OAAO,CAACC,GAAR,CAAYM,EAAZ,CAAgBA,EAAE,CAACK,KAAH,CAASC,kBAAzB,EACAN,EAAE,CAACO,gBAAH,CAAoB,cAApB,CAAoC,UAAM,CACtC9B,SAAS,GACZ,CAFD,EAGAC,KAAK,WAAIlB,UAAJ,qCAA0CsC,SAA1C,EAAuD,CACxDU,MAAM,CAAE,MADgD,CAExDC,OAAO,CAAE,CACL,eAAgB,kBADX,CAEL,cAAehD,SAFV,CAF+C,CAAvD,CAAL,CAOKkB,IAPL,CAOU,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EAPlB,EAQKF,IARL,CAQU,SAAAG,IAAI,CAAI,CACVW,OAAO,CAACC,GAAR,CAAYZ,IAAZ,EACH,CAVL,EAWH,CACJ,CArBD,CAuBA,GAAM4B,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAAC1B,CAAD,CAAI2B,MAAJ,CAAe,CAC9B3B,CAAC,CAACe,eAAF,GACA,GAAMC,CAAAA,EAAE,CAAGC,QAAQ,CAACC,aAAT,yBAAwCS,MAAxC,EAAX,CACA,GAAIR,MAAM,CAACC,OAAP,CAAe,kEAAf,CAAJ,CAAwF,CACpF1B,KAAK,WAAIlB,UAAJ,kCAAuCmD,MAAvC,EAAiD,CAClDH,MAAM,CAAE,MAD0C,CAElDC,OAAO,CAAE,CACL,eAAgB,kBADX,CAEL,cAAehD,SAFV,CAFyC,CAAjD,CAAL,CAOKkB,IAPL,CAOU,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EAPlB,EAQKF,IARL,CAQU,SAAAG,IAAI,CAAI,CACVW,OAAO,CAACC,GAAR,CAAYZ,IAAZ,EACAqB,MAAM,CAACS,QAAP,CAAgBC,IAAhB,CAAuB,GAAvB,CACH,CAXL,EAYH,CACJ,CAjBD,CAmBA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,EAAM,CAC3B7C,qBAAqB,CAAC,KAAD,CAArB,CACH,CAFD,CAIA,GAAM8C,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,EAAM,CAC7B1C,iBAAiB,CAAC,CACdH,MAAM,CAAE,KADM,CAEdC,KAAK,CAAE,IAFO,CAAD,CAAjB,CAIH,CALD,CAOA,GAAM6C,CAAAA,qBAAqB,CAAG,QAAxBA,CAAAA,qBAAwB,EAAM,CAChCzC,oBAAoB,CAAC,CACjBL,MAAM,CAAE,KADS,CAEjBC,KAAK,CAAE,IAFU,CAAD,CAApB,CAIH,CALD,CAOA,mBACI,2BAAK,SAAS,CAAC,qBAAf,EACKP,IAAI,eACD,oBAAC,YAAD,EACI,MAAM,CAAEI,kBADZ,CAEI,SAAS,CAAE8C,gBAFf,CAGI,IAAI,CAAElD,IAHV,EAFR,cAQI,oBAAC,UAAD,EACI,MAAM,CAAEQ,cAAc,CAACF,MAD3B,CAEI,KAAK,CAAEE,cAAc,CAACD,KAF1B,CAGI,SAAS,CAAE4C,kBAHf,EARJ,cAaI,oBAAC,UAAD,EACI,MAAM,CAAEzC,iBAAiB,CAACJ,MAD9B,CAEI,KAAK,CAAEI,iBAAiB,CAACH,KAF7B,CAGI,SAAS,CAAE6C,qBAHf,EAbJ,cAkBI,oBAAC,MAAD,EAAQ,IAAI,CAAC,MAAb,CAAoB,SAAS,CAAE,IAA/B,EAlBJ,cAmBI,2BAAK,SAAS,CAAC,SAAf,EACKpD,IAAI,EAAIE,OAAR,cACG,qDACI,2BAAK,SAAS,CAAC,gBAAf,eACI,2BAAK,SAAS,CAAC,gCAAf,eACI,2BAAK,SAAS,CAAC,UAAf,eACI,2BAAK,SAAS,CAAC,UAAf,eACI,oBAAC,IAAD,EAAM,EAAE,iBAAWF,IAAI,CAACqD,MAAL,CAAYC,IAAvB,CAAR,eACI,2BAAK,GAAG,WAAK1D,UAAL,SAAkBI,IAAI,CAACqD,MAAL,CAAYE,KAA9B,CAAR,CACI,SAAS,CAAC,iBADd,EADJ,CADJ,CADJ,cAQI,2BAAK,SAAS,CAAC,UAAf,eACI,oBAAC,IAAD,EAAM,EAAE,iBAAWvD,IAAI,CAACqD,MAAL,CAAYC,IAAvB,CAAR,CAAuC,KAAK,CAAE,CAAEE,KAAK,CAAE,MAAT,CAA9C,eACI,2BAAK,KAAK,CAAE,CAAEC,MAAM,CAAE,MAAV,CAAZ,eACI,kCAASzD,IAAI,CAACqD,MAAL,CAAYK,UAArB,KAAkC1D,IAAI,CAACqD,MAAL,CAAYM,SAA9C,KADJ,cAEI,yBAAG,SAAS,CAAC,+BAAb,MACM3D,IAAI,CAACqD,MAAL,CAAYO,IAAZ,CAAiBC,QADvB,YACoC7D,IAAI,CAAC8D,OAAL,CAAaC,KAAb,CAAmB,GAAnB,EAAwBC,OAAxB,GAAkCC,IAAlC,CAAuC,GAAvC,CADpC,CAFJ,CADJ,CADJ,cASI,2BAAK,KAAK,CAAE,CAAEC,SAAS,CAAE,OAAb,CAAsBC,QAAQ,CAAE,QAAhC,CAAZ,EACKnE,IAAI,CAACoE,OADV,CATJ,CAYKpE,IAAI,CAACqE,KAAL,eACG,2BAAK,GAAG,WAAKzE,UAAL,SAAkBI,IAAI,CAACqE,KAAvB,CAAR,CAAwC,SAAS,CAAC,UAAlD,EAbR,CARJ,CADJ,CA0BKnE,OAAO,CAACU,EAAR,EAAcZ,IAAI,CAACqD,MAAL,CAAYzC,EAA1B,eACG,yBACI,SAAS,CAAC,4CADd,CAEI,KAAK,CAAE,CAAE0D,MAAM,CAAE,eAAV,CAFX,CAGI,OAAO,CAAE,iBAAAlD,CAAC,QAAI0B,CAAAA,UAAU,CAAC1B,CAAD,CAAIpB,IAAI,CAACY,EAAT,CAAd,EAHd,EA3BR,CADJ,cAmCI,2BAAK,SAAS,CAAC,cAAf,eACI,yBAAG,SAAS,CAAC,gBAAb,CAA8B,KAAK,CAAE,CAAEuD,QAAQ,CAAE,OAAZ,CAArC,eACI,oBAAC,IAAD,EAAM,EAAE,iBAAWvD,EAAX,aAAR,CAAkC,SAAS,CAAC,gBAA5C,eACI,yBACI,KAAK,CAAC,gBADV,CAEI,OAAO,CAAE,yBAAMP,CAAAA,qBAAqB,CAAC,IAAD,CAA3B,EAFb,EADJ,CADJ,CAMYL,IAAI,CAACuE,QAAL,CAAcC,MAN1B,CAOKxE,IAAI,CAACO,KAAL,CAAWkE,GAAX,CAAe,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAACxE,OAAL,CAAaU,EAAjB,EAAnB,EAAwC+D,QAAxC,CAAiDzE,OAAO,CAACU,EAAzD,eACG,yBAAG,KAAK,CAAC,cAAT,CACI,cAAaZ,IAAI,CAACY,EADtB,CAEI,OAAO,CAAEO,cAFb,EADH,cAMG,yBAAG,KAAK,CAAC,cAAT,CACI,cAAanB,IAAI,CAACY,EADtB,CAEI,OAAO,CAAEO,cAFb,EAbR,cAiBI,yBAAG,SAAS,CAAC,mBAAb,CACI,OAAO,CAAE,yBAAMV,CAAAA,iBAAiB,CAAC,CAAEH,MAAM,CAAE,IAAV,CAAgBC,KAAK,CAAEP,IAAI,CAACO,KAA5B,CAAD,CAAvB,EADb,EAGKP,IAAI,CAACO,KAAL,CAAWiE,MAHhB,CAjBJ,CADJ,CAnCJ,CADJ,cA8DI,2BAAK,SAAS,CAAC,cAAf,EACKxE,IAAI,CAACuE,QAAL,CAAcE,GAAd,CAAkB,SAAAG,OAAO,CAAI,CAC1B,mBACI,0BACI,SAAS,CAAC,gBADd,CAEI,EAAE,wBAAkBA,OAAO,CAAChE,EAA1B,CAFN,CAGI,GAAG,CAAEgE,OAAO,CAAChE,EAHjB,eAKI,2BAAK,SAAS,CAAC,gCAAf,eACI,2BAAK,SAAS,CAAC,UAAf,eACI,2BAAK,SAAS,CAAC,UAAf,eACI,oBAAC,IAAD,EAAM,EAAE,iBAAWgE,OAAO,CAACvB,MAAR,CAAeC,IAA1B,CAAR,eACI,2BAAK,GAAG,WAAK1D,UAAL,SAAkBgF,OAAO,CAACvB,MAAR,CAAeE,KAAjC,CAAR,CACI,SAAS,CAAC,gBADd,EADJ,CADJ,CADJ,cAQI,2BAAK,SAAS,CAAC,UAAf,eACI,oBAAC,IAAD,EAAM,EAAE,iBAAWqB,OAAO,CAACvB,MAAR,CAAeC,IAA1B,CAAR,CAA0C,KAAK,CAAE,CAAEE,KAAK,CAAE,MAAT,CAAjD,eACI,2BAAK,KAAK,CAAE,CAAEC,MAAM,CAAE,MAAV,CAAZ,eACI,kCAASmB,OAAO,CAACvB,MAAR,CAAeK,UAAxB,KAAqCkB,OAAO,CAACvB,MAAR,CAAeM,SAApD,KADJ,cAEI,yBAAG,SAAS,CAAC,+BAAb,MACMiB,OAAO,CAACvB,MAAR,CAAeO,IAAf,CAAoBC,QAD1B,YACuCe,OAAO,CAACd,OAAR,CAAgBC,KAAhB,CAAsB,GAAtB,EAA2BC,OAA3B,GAAqCC,IAArC,CAA0C,GAA1C,CADvC,CAFJ,CADJ,CADJ,cASI,2BAAK,KAAK,CAAE,CAAEC,SAAS,CAAE,OAAb,CAAZ,EACKU,OAAO,CAACR,OADb,CATJ,CARJ,CADJ,CAuBKQ,OAAO,CAACvB,MAAR,CAAezC,EAAf,EAAqBV,OAAO,CAACU,EAA7B,eACG,yBACI,SAAS,CAAC,4CADd,CAEI,KAAK,CAAE,CAAE0D,MAAM,CAAE,eAAV,CAFX,CAGI,OAAO,CAAE,iBAAAlD,CAAC,QAAIa,CAAAA,aAAa,CAACb,CAAD,CAAIwD,OAAO,CAAChE,EAAZ,CAAjB,EAHd,EAxBR,CALJ,cAmCI,2BAAK,SAAS,CAAC,cAAf,eACI,yBAAG,SAAS,CAAC,gBAAb,EACKgE,OAAO,CAACrE,KAAR,CAAckE,GAAd,CAAkB,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAACxE,OAAL,CAAaU,EAAjB,EAAtB,EAA2C+D,QAA3C,CAAoDzE,OAAO,CAACU,EAA5D,eACG,yBAAG,KAAK,CAAC,cAAT,CACI,iBAAgBgE,OAAO,CAAChE,EAD5B,CAEI,OAAO,CAAEmB,iBAFb,EADH,cAMG,yBAAG,KAAK,CAAC,cAAT,CACI,iBAAgB6C,OAAO,CAAChE,EAD5B,CAEI,OAAO,CAAEmB,iBAFb,EAPR,cAWI,yBACI,SAAS,CAAC,mBADd,CAEI,OAAO,CAAE,yBAAMtB,CAAAA,iBAAiB,CAAC,CAAEH,MAAM,CAAE,IAAV,CAAgBC,KAAK,CAAEqE,OAAO,CAACrE,KAA/B,CAAD,CAAvB,EAFb,EAIKqE,OAAO,CAACrE,KAAR,CAAciE,MAJnB,CAXJ,CADJ,CAnCJ,CADJ,CA0DH,CA3DA,CADL,CA9DJ,CADH,cA8HG,2BAAK,SAAS,CAAC,wBAAf,eACI,2BAAK,SAAS,CAAC,QAAf,EADJ,CA/HR,CAnBJ,CADJ,CA0JH","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { Link, useParams } from 'react-router-dom'\r\n\r\nimport CommentModal from '../../components/commentmodal'\r\nimport LikesModal from '../../components/likesmodal'\r\nimport Header from '../../components/main/header'\r\nimport { SERVER_URL } from '../../settings'\r\nimport { csrftoken } from '../../utils'\r\n\r\nexport default function Post(props) {\r\n    const [post, setPost] = useState(null)\r\n    const [profile, setProfile] = useState(null)\r\n    const [commentModalIsOpen, setCommentModalIsOpen] = useState(props.commentModalIsOpen)\r\n    const [postLikesModal, setPostLikesModal] = useState({ isOpen: false, likes: null })\r\n    const [commentLikesModal, setCommentLikesModal] = useState({ isOpen: false, likes: null })\r\n\r\n    const { id } = useParams()\r\n\r\n    useEffect(() => {\r\n        fetchPost()\r\n        fetch(`${SERVER_URL}/profile-api/myprofile`)\r\n            .then(response => response.json())\r\n            .then(data => setProfile(data))\r\n    }, [])\r\n\r\n    const fetchPost = () => {\r\n        fetch(`${SERVER_URL}/post-api/post/${id}`)\r\n            .then(response => response.json())\r\n            .then(data => setPost(data))\r\n    }\r\n\r\n    const likeUnlikePost = e => {\r\n        const likeBtn = e.target\r\n        if (likeBtn.classList.contains('fas')) {\r\n            likeBtn.classList.remove('fas') //border heart\r\n            likeBtn.classList.add('far')  //filled heart\r\n            fetch(`${SERVER_URL}/post-api/unlike-post/${likeBtn.dataset.postid}`)\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    console.log(data)\r\n                    fetchPost()\r\n                })\r\n        } else {\r\n            likeBtn.classList.remove('far') //border heart\r\n            likeBtn.classList.add('fas')  //filled heart\r\n            fetch(`${SERVER_URL}/post-api/like-post/${likeBtn.dataset.postid}`)\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    console.log(data)\r\n                    fetchPost()\r\n                })\r\n        }\r\n    }\r\n\r\n    const likeUnlikeComment = e => {\r\n        const likeBtn = e.target\r\n        if (likeBtn.classList.contains('fas')) {\r\n            likeBtn.classList.remove('fas') //border heart\r\n            likeBtn.classList.add('far')  //filled heart\r\n            fetch(`${SERVER_URL}/post-api/unlike-comment/${likeBtn.dataset.commentid}`)\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    console.log(data)\r\n                    fetchPost()\r\n                })\r\n        } else {\r\n            likeBtn.classList.remove('far') //border heart\r\n            likeBtn.classList.add('fas')  //filled heart\r\n            fetch(`${SERVER_URL}/post-api/like-comment/${likeBtn.dataset.commentid}`)\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    console.log(data)\r\n                    fetchPost()\r\n                })\r\n        }\r\n    }\r\n\r\n    const deleteComment = (e, commentId) => {\r\n        e.stopPropagation()\r\n        const el = document.querySelector(`#post-comment-${commentId}`)\r\n        if (window.confirm('Tem certeza que deseja apagar o comentário?\\nEssa ação é irreversível.')) {\r\n            el.style.animationPlayState = 'running'\r\n            console.log(el, el.style.animationPlayState)\r\n            el.addEventListener('animationend', () => {\r\n                fetchPost()\r\n            })\r\n            fetch(`${SERVER_URL}/post-api/delete-comment/${commentId}`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-type': 'application/json',\r\n                    'X-CSRFToken': csrftoken,\r\n                }\r\n            })\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    console.log(data)\r\n                })\r\n        }\r\n    }\r\n\r\n    const deletePost = (e, postId) => {\r\n        e.stopPropagation()\r\n        const el = document.querySelector(`#profile-post-${postId}`)\r\n        if (window.confirm('Tem certeza que deseja apagar o post?\\nEssa ação é irreversível.')) {\r\n            fetch(`${SERVER_URL}/post-api/delete-post/${postId}`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-type': 'application/json',\r\n                    'X-CSRFToken': csrftoken,\r\n                }\r\n            })\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    console.log(data)\r\n                    window.location.href = '/'\r\n                })\r\n        }\r\n    }\r\n\r\n    const hideCommentModal = () => {\r\n        setCommentModalIsOpen(false)\r\n    }\r\n\r\n    const hidePostLikesModal = () => {\r\n        setPostLikesModal({\r\n            isOpen: false,\r\n            likes: null\r\n        })\r\n    }\r\n\r\n    const hideCommentLikesModal = () => {\r\n        setCommentLikesModal({\r\n            isOpen: false,\r\n            likes: null\r\n        })\r\n    }\r\n\r\n    return (\r\n        <div className=\"post-page-container\">\r\n            {post &&\r\n                <CommentModal\r\n                    isOpen={commentModalIsOpen}\r\n                    hideModal={hideCommentModal}\r\n                    post={post}\r\n                />\r\n            }\r\n            <LikesModal\r\n                isOpen={postLikesModal.isOpen}\r\n                likes={postLikesModal.likes}\r\n                hideModal={hidePostLikesModal}\r\n            />\r\n            <LikesModal\r\n                isOpen={commentLikesModal.isOpen}\r\n                likes={commentLikesModal.likes}\r\n                hideModal={hideCommentLikesModal}\r\n            />\r\n            <Header page=\"Post\" backArrow={true} />\r\n            <div className=\"content\">\r\n                {post && profile ?\r\n                    <>\r\n                        <div className=\"post-container\">\r\n                            <div className=\"d-flex justify-content-between\">\r\n                                <div className=\"post-row\">\r\n                                    <div className=\"post-col\">\r\n                                        <Link to={`/user/${post.author.slug}`}>\r\n                                            <img src={`${SERVER_URL}${post.author.photo}`}\r\n                                                className=\"profile-img-med\"\r\n                                            />\r\n                                        </Link>\r\n                                    </div>\r\n                                    <div className=\"post-col\">\r\n                                        <Link to={`/user/${post.author.slug}`} style={{ color: '#000' }}>\r\n                                            <div style={{ height: '30px' }}>\r\n                                                <strong>{post.author.first_name} {post.author.last_name} </strong>\r\n                                                <p className=\"text-secondary d-inline-block\">\r\n                                                    @{post.author.user.username} • {post.created.split('-').reverse().join('/')}\r\n                                                </p>\r\n                                            </div>\r\n                                        </Link>\r\n                                        <div style={{ textAlign: 'start', fontSize: 'larger' }}>\r\n                                            {post.content}\r\n                                        </div>\r\n                                        {post.image &&\r\n                                            <img src={`${SERVER_URL}${post.image}`} className=\"post-img\" />\r\n                                        }\r\n                                    </div>\r\n                                </div>\r\n                                {profile.id == post.author.id &&\r\n                                    <i\r\n                                        className=\"far fa-trash-alt trash-icon text-secondary\"\r\n                                        style={{ margin: '20px 20px 0 0' }}\r\n                                        onClick={e => deletePost(e, post.id)}\r\n                                    />\r\n                                }\r\n                            </div>\r\n                            <div className=\"post-actions\">\r\n                                <p className=\"text-secondary\" style={{ fontSize: 'large' }}>\r\n                                    <Link to={`/post/${id}/comentar`} className=\"text-secondary\">\r\n                                        <i\r\n                                            class=\"far fa-comment\"\r\n                                            onClick={() => setCommentModalIsOpen(true)}\r\n                                        />\r\n                                    </Link>{post.comments.length}\r\n                                    {post.likes.map(like => like.profile.id).includes(profile.id) ?\r\n                                        <i class=\"fas fa-heart\"\r\n                                            data-postid={post.id}\r\n                                            onClick={likeUnlikePost}\r\n                                        />\r\n                                        :\r\n                                        <i class=\"far fa-heart\"\r\n                                            data-postid={post.id}\r\n                                            onClick={likeUnlikePost}\r\n                                        />}\r\n                                    <p className=\"post-likes-number\"\r\n                                        onClick={() => setPostLikesModal({ isOpen: true, likes: post.likes })}\r\n                                    >\r\n                                        {post.likes.length}\r\n                                    </p>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"comment-list\">\r\n                            {post.comments.map(comment => {\r\n                                return (\r\n                                    <li\r\n                                        className=\"post-container\"\r\n                                        id={`post-comment-${comment.id}`}\r\n                                        key={comment.id}\r\n                                    >\r\n                                        <div className=\"d-flex justify-content-between\">\r\n                                            <div className=\"post-row\">\r\n                                                <div className=\"post-col\">\r\n                                                    <Link to={`/user/${comment.author.slug}`}>\r\n                                                        <img src={`${SERVER_URL}${comment.author.photo}`}\r\n                                                            className=\"profile-img-sm\"\r\n                                                        />\r\n                                                    </Link>\r\n                                                </div>\r\n                                                <div className=\"post-col\">\r\n                                                    <Link to={`/user/${comment.author.slug}`} style={{ color: '#000' }}>\r\n                                                        <div style={{ height: '30px' }}>\r\n                                                            <strong>{comment.author.first_name} {comment.author.last_name} </strong>\r\n                                                            <p className=\"text-secondary d-inline-block\">\r\n                                                                @{comment.author.user.username} • {comment.created.split('-').reverse().join('/')}\r\n                                                            </p>\r\n                                                        </div>\r\n                                                    </Link>\r\n                                                    <div style={{ textAlign: 'start' }}>\r\n                                                        {comment.content}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                            {comment.author.id == profile.id &&\r\n                                                <i\r\n                                                    className=\"far fa-trash-alt trash-icon text-secondary\"\r\n                                                    style={{ margin: '20px 20px 0 0' }}\r\n                                                    onClick={e => deleteComment(e, comment.id)}\r\n                                                />}\r\n                                        </div>\r\n                                        <div className=\"post-actions\">\r\n                                            <p className=\"text-secondary\">\r\n                                                {comment.likes.map(like => like.profile.id).includes(profile.id) ?\r\n                                                    <i class=\"fas fa-heart\"\r\n                                                        data-commentid={comment.id}\r\n                                                        onClick={likeUnlikeComment}\r\n                                                    />\r\n                                                    :\r\n                                                    <i class=\"far fa-heart\"\r\n                                                        data-commentid={comment.id}\r\n                                                        onClick={likeUnlikeComment}\r\n                                                    />}\r\n                                                <p\r\n                                                    className=\"post-likes-number\"\r\n                                                    onClick={() => setPostLikesModal({ isOpen: true, likes: comment.likes })}\r\n                                                >\r\n                                                    {comment.likes.length}\r\n                                                </p>\r\n                                            </p>\r\n                                        </div>\r\n                                    </li>\r\n                                )\r\n                            })}\r\n                        </div>\r\n                    </> :\r\n                    <div className=\"posts-loader-container\" >\r\n                        <div className=\"loader\" />\r\n                    </div>\r\n                }\r\n            </div>\r\n        </div>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}