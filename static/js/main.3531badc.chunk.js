(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{27:function(e,t,a){e.exports=a(39)},32:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(14),c=a.n(s),o=(a(32),a(6)),l=a(3),i=a(5);function m(e){return r.a.createElement("div",{className:"sidebar"},r.a.createElement(l.b,{to:"/",style:{textDecoration:"none"}},r.a.createElement("h2",null,"Napker")),r.a.createElement("ul",null,r.a.createElement(l.b,{to:"/",style:{textDecoration:"none"}},r.a.createElement("li",null,r.a.createElement("i",{className:"fas fa-home"}),"Home")),r.a.createElement(l.b,{to:"/notifica\xe7\xf5es",style:{textDecoration:"none"}},r.a.createElement("li",null,r.a.createElement("i",{className:"fas fa-bell"}),"Notifica\xe7\xf5es",e.notificationsNumber?r.a.createElement("p",{id:"notifications-number"},e.notificationsNumber):"")),r.a.createElement(l.b,{to:"/mensagens",style:{textDecoration:"none"}},r.a.createElement("li",null,r.a.createElement("i",{className:"fas fa-envelope"}),"Mensagens",e.unreadMessagesNumber?r.a.createElement("p",{id:"notifications-number"},e.unreadMessagesNumber):"")),r.a.createElement(l.b,{to:"/perfil",style:{textDecoration:"none"}},r.a.createElement("li",null,r.a.createElement("i",{className:"fas fa-user"}),"Perfil")),r.a.createElement(l.b,{to:"/configura\xe7\xf5es",style:{textDecoration:"none"}},r.a.createElement("li",null,r.a.createElement("i",{className:"fas fa-cog"}),"Configura\xe7\xf5es"))))}function u(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"form-row d-inline-block"},r.a.createElement("div",{className:"col d-flex"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"O que est\xe1 acontecendo?",style:{marginRight:"5px",width:"400px"}}),r.a.createElement("button",{className:"btn btn-primary",style:{marginBottom:"20px",borderRadius:"5px"}},"Postar"))),r.a.createElement("div",{className:"list-group"}))}var f="http://127.0.0.1:8000",d=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var a=document.cookie.split(";"),n=0;n<a.length;n++){var r=a[n].trim();if(r.substring(0,e.length+1)===e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}return t}("csrftoken");function p(){window.confirm("Sair do Napker?\nVoc\xea poder\xe1 entrar novamente quando quiser.")&&window.location.replace("".concat(f,"/logout"))}function h(e){var t=Object(n.useState)([]),a=Object(o.a)(t,2),s=a[0],c=a[1],i=Object(n.useState)(null),m=Object(o.a)(i,2),u=m[0],p=m[1],h=Object(n.useState)(""),g=Object(o.a)(h,2),E=g[0],b=g[1];Object(n.useEffect)((function(){console.log("fetching profiles..."),fetch("".concat(f,"/profile-api/profile-list")).then((function(e){return e.json()})).then((function(e){p(null),c(e)}))}),[]),Object(n.useEffect)((function(){""!==E?fetch("".concat(f,"/profile-api/users/").concat(E)).then((function(e){return e.json()})).then((function(e){p(e)})):p(null)}),[E]);var v=function(e){var t,a=e.target;"Solicitar"===a.innerHTML?(t=a.dataset.pk,fetch("".concat(f,"/profile-api/send-friend-request"),{method:"POST",headers:{"Content-type":"application/json","X-CSRFToken":d},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){return console.log(e)})),a.innerHTML="Solicitado",a.className="btn btn-primary"):(!function(e){fetch("".concat(f,"/profile-api/cancel-friend-request"),{method:"POST",headers:{"Content-type":"application/json","X-CSRFToken":d},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return console.log(e)}))}(a.dataset.pk),a.innerHTML="Solicitar",a.className="btn btn-secondary")};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"form-row d-inline-block"},r.a.createElement("div",{className:"col"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Pesquisar",style:{width:"400px"},value:E,onChange:function(e){return b(e.target.value)}}))),r.a.createElement("div",{className:"list-group"},u?u.map((function(e){return r.a.createElement(l.b,{to:"/user/".concat(e.slug),style:{color:"#000",textDecoration:"none"}},r.a.createElement("li",{className:"list-group-item profile-row filtered-profile",key:e.id},r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("div",{className:"profile-col"},r.a.createElement("img",{src:"".concat(f).concat(e.photo)}),r.a.createElement("div",{className:"main-profile-data"},r.a.createElement("strong",null,e.first_name," ",e.last_name),r.a.createElement("p",{className:"text-secondary"},"@",e.user.username))),r.a.createElement("div",{className:"profile-col"},e.bio),r.a.createElement("div",{className:"profile-col"}))))})):s&&s.map((function(e){return r.a.createElement("li",{className:"list-group-item profile-row",key:e.id},r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("div",{className:"profile-col"},r.a.createElement(l.b,{to:"/user/".concat(e.slug)},r.a.createElement("img",{src:"".concat(f).concat(e.photo)})),r.a.createElement("div",{className:"main-profile-data"},r.a.createElement(l.b,{to:"/user/".concat(e.slug),style:{color:"#000"}},r.a.createElement("strong",null,e.first_name," ",e.last_name)),r.a.createElement("p",{className:"text-secondary"},"@",e.user.username))),r.a.createElement("div",{className:"profile-col"},e.bio),r.a.createElement("div",{className:"profile-col"},r.a.createElement("button",{className:"btn btn-secondary","data-pk":e.user.id,onClick:v},"Solicitar"))))}))))}function g(e){return r.a.createElement("div",{className:"header fixed-top"},e.backArrow?r.a.createElement("i",{class:"fas fa-arrow-left profile-left-arrow",onClick:function(){return window.history.back()}}):"",r.a.createElement("strong",null,e.page),r.a.createElement("a",{className:"logout",onClick:p},"Sair"))}function E(e){var t=Object(n.useState)("Perfis"),a=Object(o.a)(t,2),s=a[0],c=a[1],l={Perfis:r.a.createElement(h,null),Posts:r.a.createElement(u,null)};return document.title="Home / Napker",r.a.createElement(r.a.Fragment,null,r.a.createElement(g,{page:"Home"}),r.a.createElement("div",{className:"content"},r.a.createElement("button",{type:"button",className:"btn btn-primary",style:{marginRight:"50px",borderRadius:"20px"},onClick:function(){return c("Perfis"===s?"Posts":"Perfis")}},"Perfis"===s?"Ver posts":"Ver perfis"),l[s]))}function b(e){var t=Object(n.useState)([]),a=Object(o.a)(t,2),s=a[0],c=a[1];document.title="Notifica\xe7\xf5es / Napker",Object(n.useEffect)((function(){fetch("".concat(f,"/profile-api/myinvites")).then((function(e){return e.json()})).then((function(e){return c(e)}))}),[]);var i=function(t){var a=t.target,n={senderid:a.dataset.senderid,reply:a.dataset.reply};fetch("".concat(f,"/profile-api/reply-friend-request"),{method:"POST",headers:{"Content-type":"application/json","X-CSRFToken":d},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(t){console.log(t),e.updateNotificationsNumber()})),document.getElementById("friend-request-list").removeChild(document.getElementById(a.dataset.senderid))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(g,{page:"Notifica\xe7\xf5es"}),r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"list-group",id:"friend-request-list"},s.length?s.map((function(e){return r.a.createElement("li",{className:"list-group-item profile-row",id:e.sender.id,key:e.sender.id},r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("div",{className:"profile-col"},r.a.createElement(l.b,{to:"/user/".concat(e.sender.slug)},r.a.createElement("img",{src:"".concat(f).concat(e.sender.photo)})),r.a.createElement("div",{className:"main-profile-data"},r.a.createElement(l.b,{to:"/user/".concat(e.sender.slug),style:{color:"#000"}},r.a.createElement("strong",null,e.sender.first_name," ",e.sender.last_name)),r.a.createElement("p",{className:"text-secondary"},"@",e.sender.user.username))),r.a.createElement("div",{className:"profile-col"},e.sender.bio),r.a.createElement("div",{className:"profile-col",style:{justifyContent:"space-between"}},r.a.createElement("button",{className:"btn btn-primary btn-reply-fr","data-senderid":e.sender.id,"data-reply":"accept",onClick:i},"Confirmar"),r.a.createElement("button",{className:"btn btn-grey btn-reply-fr","data-senderid":e.sender.id,"data-reply":"decline",onClick:i},"Excluir"))))})):r.a.createElement("h3",{style:{marginTop:"100px"}},"Voc\xea ainda n\xe3o tem nenhuma notifica\xe7\xe3o"))))}var v=a(13),y=a(12),N=a(16),k=a(15),j=a(11),S=a(25),C=a(26),O=function(){function e(){Object(v.a)(this,e),this.callbacks={},this.socketRef=null}return Object(y.a)(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),Object(y.a)(e,[{key:"connect",value:function(e){var t=this,a="".concat("ws://127.0.0.1:8000","/ws/chat/").concat(e,"/");this.socketRef=new WebSocket(a),this.socketRef.onopen=function(){console.log("WebSocket open")},this.socketNewMessage(JSON.stringify({command:"fetch-messages"})),this.socketRef.onmessage=function(e){t.socketNewMessage(e.data)},this.socketRef.onerror=function(e){console.log(e.message)},this.socketRef.onclose=function(){console.log("WebSocket closed let's reopen"),t.connect(e)}}},{key:"disconnect",value:function(){this.socketRef&&this.socketRef.close()}},{key:"socketNewMessage",value:function(e){var t=JSON.parse(e),a=t.command;0!==Object.keys(this.callbacks).length&&("messages"===a&&this.callbacks[a](t.messages),"new_message"===a&&this.callbacks[a](t.message))}},{key:"fetchMessages",value:function(e,t){this.sendMessage({command:"fetch_messages",username:e,chatId:t})}},{key:"newChatMessage",value:function(e){this.sendMessage({command:"new_message",from:e.from,content:e.content,chatId:e.chatId})}},{key:"addCallbacks",value:function(e,t){this.callbacks.messages=e,this.callbacks.new_message=t}},{key:"sendMessage",value:function(e){try{this.socketRef.send(JSON.stringify(Object(C.a)({},e)))}catch(t){console.log(t.message)}}},{key:"state",value:function(){return this.socketRef?this.socketRef.readyState:0}}]),e}();O.instance=null;var x=O.getInstance(),w=function(e){Object(N.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).messageChangeHandler=function(e){n.setState({message:e.target.value})},n.sendMessageHandler=function(e){e.preventDefault();var t={from:n.props.username,content:n.state.message,chatId:n.props.chatId};x.newChatMessage(t),n.setState({message:""})},n.renderTimestamp=function(e){var t=Math.round(((new Date).getTime()-new Date(e).getTime())/6e4);return t<1?"agora pouco...":1===t?"1 minuto atr\xe1s":t<60&&t>1?"".concat(t," minutos atr\xe1s"):1===Math.round(t/60)?"1 hora atr\xe1s":t<1440&&t>60?"".concat(Math.round(t/60)," horas atr\xe1s"):1===Math.round(t/1440)?"1 dia atr\xe1s":t<44640&&t>1440?"".concat(Math.round(t/1440)," dias atr\xe1s"):"".concat(new Date(e))},n.renderMessages=function(e){var t=n.props.username;return e.map((function(e,a,s){return r.a.createElement("li",{key:e.id,className:e.author===t?"sent":"received"},r.a.createElement("p",null,e.content,r.a.createElement("br",null),r.a.createElement("small",null,n.renderTimestamp(e.timestamp))))}))},n.scrollToBottom=function(){if(document.querySelector("#chat-log")){var e=document.querySelector("#chat-log");e.scrollTop=e.scrollHeight}},n.handleComponentChange=function(){n.scrollToBottom(),!n.state.otherUsername||n.state.otherProfile&&n.state.otherProfile.user.username===n.state.otherUsername||fetch("".concat(f,"/profile-api/user/").concat(n.state.otherUsername)).then((function(e){return e.json()})).then((function(e){return n.setState({otherProfile:e})}))},n.state={message:"",messages:[],otherUsername:n.props.otherUsername,otherProfile:null},n.initialiseChat(),n}return Object(y.a)(a,[{key:"initialiseChat",value:function(){var e=this;this.waitForSocketConnection((function(){x.addCallbacks(e.setMessages.bind(e),e.addMessage.bind(e)),x.fetchMessages(e.props.username,e.props.chatId)})),this.props.chatId&&x.connect(this.props.chatId)}}]),Object(y.a)(a,[{key:"waitForSocketConnection",value:function(e){var t=this;setTimeout((function(){if(1===x.state())return console.log("Connection is made"),void e();console.log("wait for connection..."),t.waitForSocketConnection(e)}),100)}},{key:"setMessages",value:function(e){this.setState({messages:e.reverse()})}},{key:"addMessage",value:function(e){this.setState({messages:[].concat(Object(S.a)(this.state.messages),[e])})}},{key:"componentDidMount",value:function(){this.handleComponentChange()}},{key:"componentDidUpdate",value:function(){this.handleComponentChange()}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.props.chatId!==e.chatId&&(x.disconnect(),this.waitForSocketConnection((function(){x.fetchMessages(t.props.username,e.chatId)})),x.connect(e.chatId)),this.state.otherUsername!=e.otherUsername&&this.setState({otherUsername:e.otherUsername}),e.chatId&&fetch("".concat(f,"/chat-api/read-messages"),{method:"POST",headers:{"Content-type":"application/json","X-CSRFToken":d},body:JSON.stringify({chat_id:e.chatId})}).then((function(e){return e.json()})).then((function(e){return console.log(e)})),this.props.updateUnreadMessagesNumber&&this.props.updateUnreadMessagesNumber()}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,this.state.otherProfile?r.a.createElement("div",{className:"d-flex flex-column justify-content-between align-items-center current-chat"},r.a.createElement("div",{className:"current-chat-header"},r.a.createElement(l.b,{to:"/user/".concat(this.state.otherProfile.slug)},r.a.createElement("img",{src:"".concat(f).concat(this.state.otherProfile.photo),className:"header-profile-img"})),r.a.createElement("div",{className:"d-flex flex-column align-items-start",style:{height:"52px"}},r.a.createElement("strong",null,this.state.otherProfile.first_name," ",this.state.otherProfile.last_name),r.a.createElement("p",{className:"text-secondary"},"@",this.state.otherProfile.user.username))),r.a.createElement("div",{id:"chat-log"},this.state.messages?this.renderMessages(this.state.messages):""),r.a.createElement("form",{className:"send-message-container",onSubmit:this.sendMessageHandler},r.a.createElement("input",{placeholder:"Mensagem",className:"message-input",id:"chat-message-input",value:this.state.message,onChange:this.messageChangeHandler}),r.a.createElement("button",{className:"btn btn-primary",id:"chat-message-submit"},r.a.createElement("i",{class:"fas fa-paper-plane",style:{position:"relative",right:"10%"}})))):r.a.createElement("div",{className:"d-flex flex-column justify-content-center align-items-center current-chat"},r.a.createElement("div",null,r.a.createElement("strong",{style:{fontSize:"larger"}},"Voc\xea n\xe3o tem uma conversa selecionada"),r.a.createElement("p",{className:"text-secondary"},"Selecione uma existente ou comece uma nova"),r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return e.props.openModal()}},"Nova conversa"))))}}]),a}(r.a.Component),M=function(e){Object(N.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).fetchActiveChatProfiles=function(){fetch("".concat(f,"/chat-api/active-chats-profiles")).then((function(e){return e.json()})).then((function(e){n.state.username&&n.setState({activeChatsProfiles:e.reverse()})}))},n.openModal=function(){n.setState({addingNewChat:!0})},n.setModalSearch=function(e){""!==e?fetch("".concat(f,"/profile-api/users/").concat(e)).then((function(e){return e.json()})).then((function(e){n.setState({modalProfiles:e})})):n.setState({modalProfiles:[]})},n.setContactSearch=function(e){if(""!==e){if(n.state.activeChatsProfiles){var t=n.state.activeChatsProfiles.filter((function(t){return t.user.username.includes(e)}));n.setState({activeChatsProfiles:t})}}else n.fetchActiveChatProfiles()},n.state={username:null,chatId:null,activeChatsProfiles:null,addingNewChat:!1,modalProfiles:[]},n}return Object(y.a)(a,[{key:"componentWillReceiveProps",value:function(e){var t=this;if(e!==this.props){var a={username:this.state.username,other_username:e.match.params.slug};fetch("".concat(f,"/chat-api/chat-id/").concat(JSON.stringify(a))).then((function(e){return e.json()})).then((function(e){return t.setState({chatId:e.chat_id})}))}}},{key:"handleComponentChange",value:function(){var e=this;this.state.username||fetch("".concat(f,"/profile-api/logged-user")).then((function(e){return e.json()})).then((function(t){return e.setState({username:t.username})})),this.state.activeChatsProfiles||this.state.activeChatsProfiles===[]||this.fetchActiveChatProfiles()}},{key:"componentWillMount",value:function(){document.title="Mensagens / Napker",this.handleComponentChange()}},{key:"componentDidUpdate",value:function(){this.handleComponentChange()}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(g,{page:"Mensagens"}),r.a.createElement("div",{className:"content d-flex messages-wrapper"},r.a.createElement(j.a,{show:this.state.addingNewChat,onHide:function(){return e.setState({addingNewChat:!1})},size:"lg"},r.a.createElement(j.a.Header,{closeButton:!0},r.a.createElement(j.a.Title,null,r.a.createElement("strong",null,"Nova conversa"))),r.a.createElement(j.a.Body,{style:{padding:"0"}},r.a.createElement("input",{className:"modal-search-input",placeholder:"Pesquisar pessoas",onChange:function(t){return e.setModalSearch(t.target.value)}}),r.a.createElement("div",{className:"list-group",style:{height:"400px",overflow:"hidden",overflowY:"scroll"}},this.state.modalProfiles&&this.state.modalProfiles.map((function(t){return r.a.createElement(l.b,{to:"/mensagens/".concat(t.slug),style:{color:"#000",textDecoration:"none"},onClick:function(){return e.setState({addingNewChat:!1})}},r.a.createElement("li",{className:"list-group-item profile-row modal-profile-li",key:t.id},r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("div",{className:"profile-col"},r.a.createElement("img",{src:"".concat(f).concat(t.photo)}),r.a.createElement("div",{className:"main-profile-data"},r.a.createElement("strong",null,t.first_name," ",t.last_name),r.a.createElement("p",{className:"text-secondary"},"@",t.user.username))),r.a.createElement("div",{className:"profile-col"},t.bio))))}))))),r.a.createElement("div",{className:"d-flex flex-column chats-list"},r.a.createElement("div",{className:"search-input-container"},r.a.createElement("input",{placeholder:"Pesquisar pessoas",className:"search-input",onChange:function(t){return e.setContactSearch(t.target.value)}})),r.a.createElement("div",{className:"list-group chats-container"},this.state.activeChatsProfiles&&this.state.activeChatsProfiles.map((function(e){return r.a.createElement(l.b,{to:"/mensagens/".concat(e.user.username),style:{color:"#000",textDecoration:"none"}},r.a.createElement("li",{className:"list-item profile-chat-item",style:{whiteSpace:"nowrap"}},r.a.createElement("img",{src:"".concat(f).concat(e.photo),alt:"",style:{borderRadius:"50%"}}),r.a.createElement("strong",null,e.first_name," ",e.last_name),r.a.createElement("p",{className:"text-secondary",style:{marginLeft:"5px"}},"@",e.user.username)))})))),r.a.createElement(w,{username:this.state.username,otherUsername:this.props.match.params.slug,chatId:this.state.chatId,openModal:this.openModal,updateUnreadMessagesNumber:this.props.updateUnreadMessagesNumber})))}}]),a}(r.a.Component);function P(){var e=Object(n.useState)(null),t=Object(o.a)(e,2),a=t[0],s=t[1],c=Object(n.useState)(!1),i=Object(o.a)(c,2),m=i[0],u=i[1],p={borderRadius:"50%",display:"inline-block",transform:"scale(1.5)",marginBottom:"25px"};return document.title="Perfil / Napker",Object(n.useEffect)((function(){fetch("".concat(f,"/profile-api/myprofile")).then((function(e){return e.json()})).then((function(e){return s(e)}))}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(g,{page:"Perfil"}),a?r.a.createElement("div",{className:"content"},r.a.createElement(j.a,{show:m,onHide:function(){return u(!1)},size:"lg"},r.a.createElement(j.a.Header,{closeButton:!0},r.a.createElement(j.a.Title,null,"Editar perfil")),r.a.createElement(j.a.Body,null,r.a.createElement("form",{action:"".concat(f,"/update-profile"),id:"update-profile-form",method:"POST"},r.a.createElement("input",{type:"hidden",name:"csrfmiddlewaretoken",value:d}),r.a.createElement("div",{className:"d-flex flex-column justify-content-center align-items-center",style:{padding:"25px"}},r.a.createElement("img",{src:"".concat(f).concat(a.photo),style:p}),r.a.createElement("input",{type:"file",accept:"image/png, image/jpg",name:"profile-photo",onChange:function(e){return console.log(e.target.files)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"first-name",className:"profile-label"},"Nome:"),r.a.createElement("input",{className:"form-control",type:"text",name:"first-name",id:"first-name",placeholder:a.first_name})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"last-name",className:"profile-label"},"Sobrenome:"),r.a.createElement("input",{className:"form-control",type:"text",name:"last-name",id:"last-name",placeholder:a.last_name})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"username",className:"profile-label"},"Nome de usu\xe1rio:"),r.a.createElement("input",{className:"form-control",type:"text",name:"username",id:"username",placeholder:a.user.username}),r.a.createElement("span",{id:"username-taken"},"Nome de usu\xe1rio j\xe1 existe")),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"email",className:"profile-label"},"Email:"),r.a.createElement("input",{className:"form-control",type:"email",name:"email",id:"email",placeholder:a.email})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"gender",className:"profile-label"},"G\xeanero:"),r.a.createElement("select",{className:"form-control",name:"gender",id:"gender",placeholder:a.gender},r.a.createElement("option",{value:"male"},"Masculino"),r.a.createElement("option",{value:"female"},"Feminino"),r.a.createElement("option",{value:"other"},"Outro"))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"birth-date",className:"profile-label"},"Data de nascimento:"),r.a.createElement("input",{className:"form-control",type:"date",name:"birth-date",id:"birth-date",defaultValue:a.birth_date})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"bio",className:"profile-label"},"Bio:"),r.a.createElement("input",{className:"form-control",type:"email",name:"bio",id:"bio",placeholder:a.bio})))),r.a.createElement(j.a.Footer,null,r.a.createElement("button",{className:"btn btn-grey",onClick:function(){return u(!1)}},"Fechar"),r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return document.querySelector("form#update-profile-form").submit()}},"Salvar"))),r.a.createElement("div",{className:"d-flex justify-content-between align-items-center profile-data-container"},r.a.createElement("div",{className:"d-flex flex-column align-items-start"},r.a.createElement("p",{style:{padding:"15px"}},r.a.createElement("img",{src:"".concat(f).concat(a.photo),style:p})),r.a.createElement("p",{style:{marginBottom:0}},r.a.createElement("strong",null,a.first_name," ",a.last_name)),r.a.createElement("p",{className:"text-secondary",style:{marginTop:0}},"@",a.user.username),r.a.createElement("p",null,a.bio),r.a.createElement("p",{className:"text-secondary"},r.a.createElement("i",{className:"far fa-calendar-alt"})," Entrou em ",a.created.split("-").reverse().join("/")),r.a.createElement("p",null,r.a.createElement(l.b,{to:"/user/".concat(a.slug,"/amigos"),style:{color:"#000"}},r.a.createElement("strong",null,a.friends.length)," ",1===a.friends.length?"amigo":"amigos"))),r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-secondary",type:"button",onClick:function(){return u(!0)}},"Editar perfil")))):"")}function T(){return document.title="Configura\xe7\xf5es / Napker",r.a.createElement(r.a.Fragment,null,r.a.createElement(g,{page:"Configura\xe7\xf5es"}),r.a.createElement("div",{className:"content"},"Configura\xe7\xf5es"))}var F=function(e){Object(N.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).profilePhotoStyle={borderRadius:"50%",display:"inline-block",transform:"scale(1.5)",marginBottom:"25px"},n.sendFriendRequest=function(e){fetch("".concat(f,"/profile-api/send-friend-request"),{method:"POST",headers:{"Content-type":"application/json","X-CSRFToken":d},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return console.log(e)}))},n.cancelFriendRequest=function(e){fetch("".concat(f,"/profile-api/cancel-friend-request"),{method:"POST",headers:{"Content-type":"application/json","X-CSRFToken":d},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return console.log(e)}))},n.removeFromFriends=function(e){fetch("".concat(f,"/profile-api/remove-from-friends"),{method:"POST",headers:{"Content-type":"application/json","X-CSRFToken":d},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return console.log(e)}))},n.acceptFriendRequest=function(e){fetch("".concat(f,"/profile-api/reply-friend-request"),{method:"POST",headers:{"Content-type":"application/json","X-CSRFToken":d},body:JSON.stringify({senderid:e,reply:"accept"})}).then((function(e){return e.json()})).then((function(e){return console.log(e)}))},n.handleRelationshipUpdate=function(e){var t=e.target;"Solicitar"===t.innerHTML?(n.sendFriendRequest(t.dataset.pk),t.innerHTML="Solicitado",t.className="btn btn-primary"):"Solicitado"===t.innerHTML?(n.cancelFriendRequest(t.dataset.pk),t.innerHTML="Solicitar",t.className="btn btn-secondary"):"Amigos"===t.innerHTML||"Remover"===t.innerHTML?window.confirm("Remover @".concat(n.state.profile.user.username," dos amigos?"))&&(n.removeFromFriends(t.dataset.pk),t.innerHTML="Solicitar",t.className="btn btn-secondary"):"Aceitar"===t.innerHTML&&(n.acceptFriendRequest(t.dataset.pk),t.innerHTML="Amigos",t.className="btn btn-primary",console.log(n.props),n.props.updateNotificationsNumber())},n.state={profile:null,relationshipButtonLabel:""},n.slug=n.props.match.params.slug,n}return Object(y.a)(a,[{key:"componentWillMount",value:function(){var e=this;fetch("".concat(f,"/profile-api/user/").concat(this.slug)).then((function(e){return e.json()})).then((function(t){return e.setState({profile:t})}))}},{key:"componentDidMount",value:function(){var e=this;fetch("".concat(f,"/profile-api/relationship/").concat(this.slug)).then((function(e){return e.json()})).then((function(t){var a;switch(t.relationship){case"friends":a="Amigos";break;case"invite-sent":a="Solicitado";break;case"invite-received":a="Aceitar";break;case"none":a="Solicitar"}e.setState({relationshipButtonLabel:a})}))}},{key:"componentDidUpdate",value:function(){var e=document.querySelector("#profile-page-relationship-btn");if(e)switch(e.innerHTML){case"Amigos":e.classList.add("btn-primary"),e.onmouseenter=function(){e.innerHTML="Remover"},e.onmouseout=function(){e.innerHTML="Amigos"},e.classList.add("friend-btn"),e.classList.remove("d-none");break;case"Solicitado":case"Aceitar":e.classList.add("btn-primary"),e.classList.remove("d-none");break;case"Solicitar":e.classList.add("btn-secondary"),e.classList.remove("d-none")}}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(g,{page:this.state.profile?"".concat(this.state.profile.first_name," ").concat(this.state.profile.last_name):"Perfil",backArrow:!0}),this.state.profile?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"d-flex justify-content-between align-items-center profile-data-container"},r.a.createElement("div",{className:"d-flex flex-column align-items-start"},r.a.createElement("p",{style:{padding:"15px"}},r.a.createElement("img",{src:"".concat(f).concat(this.state.profile.photo),style:this.profilePhotoStyle})),r.a.createElement("p",{style:{marginBottom:0}},r.a.createElement("strong",null,this.state.profile.first_name," ",this.state.profile.last_name)),r.a.createElement("p",{className:"text-secondary",style:{marginTop:0}},"@",this.state.profile.user.username),r.a.createElement("p",null,this.state.profile.bio),r.a.createElement("p",{className:"text-secondary"},r.a.createElement("i",{className:"far fa-calendar-alt"})," Entrou em ",this.state.profile.created.split("-").reverse().join("/")),r.a.createElement("p",null,r.a.createElement(l.b,{to:"/user/".concat(this.state.profile.slug,"/amigos"),style:{color:"#000"}},r.a.createElement("strong",null,this.state.profile.friends.length)," ",1===this.state.profile.friends.length?"amigo":"amigos"))),r.a.createElement("div",null,r.a.createElement("button",{className:"btn d-none",id:"profile-page-relationship-btn","data-pk":this.state.profile.user.id,onClick:this.handleRelationshipUpdate},this.state.relationshipButtonLabel))))):r.a.createElement(r.a.Fragment,null))}}]),a}(r.a.Component);function R(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),a=t[0],s=t[1],c=Object(n.useState)(null),m=Object(o.a)(c,2),u=m[0],d=m[1],p=Object(i.f)().slug;return Object(n.useEffect)((function(){fetch("".concat(f,"/profile-api/user/").concat(p)).then((function(e){return e.json()})).then((function(e){return d(e)}))}),[]),Object(n.useEffect)((function(){u&&fetch("".concat(f,"/profile-api/get-friends-profiles/").concat(u.slug)).then((function(e){return e.json()})).then((function(e){return s(e)}))}),[u]),r.a.createElement(r.a.Fragment,null,console.log(u,p),r.a.createElement(g,{page:u?"".concat(u.first_name," ").concat(u.last_name," / Amigos"):"Perfil / Amigos",backArrow:!0}),r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"lidt-group"},a&&a.map((function(e){return r.a.createElement(l.b,{to:"/user/".concat(e.slug),style:{color:"#000",textDecoration:"none"}},r.a.createElement("li",{className:"list-group-item profile-row filtered-profile",key:e.id},r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("div",{className:"profile-col"},r.a.createElement("img",{src:"".concat(f).concat(e.photo)}),r.a.createElement("div",{className:"main-profile-data"},r.a.createElement("strong",null,e.first_name," ",e.last_name),r.a.createElement("p",{className:"text-secondary"},"@",e.user.username))),r.a.createElement("div",{className:"profile-col"},e.bio),r.a.createElement("div",{className:"profile-col"}))))})))))}function _(){var e=Object(n.useState)(0),t=Object(o.a)(e,2),a=t[0],s=t[1],c=Object(n.useState)(0),u=Object(o.a)(c,2),d=u[0],p=u[1];Object(n.useEffect)((function(){h(),g()}),[]);var h=function(){fetch("".concat(f,"/profile-api/myinvites")).then((function(e){return e.json()})).then((function(e){return s(e.length)}))},g=function(){fetch("".concat(f,"/chat-api/all-unread-messages-number")).then((function(e){return e.json()})).then((function(e){return p(e.unread_messages_number)}))};return r.a.createElement(l.a,null,r.a.createElement(m,{notificationsNumber:a,unreadMessagesNumber:d}),r.a.createElement("div",{className:"main-content"},r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/notifica\xe7\xf5es",render:function(e){return r.a.createElement(b,Object.assign({},e,{updateNotificationsNumber:h}))}}),r.a.createElement(i.a,{path:"/mensagens",exact:!0,component:M}),r.a.createElement(i.a,{path:"/mensagens/:slug",render:function(e){return r.a.createElement(M,Object.assign({},e,{updateUnreadMessagesNumber:g}))}}),r.a.createElement(i.a,{path:"/perfil",component:P}),r.a.createElement(i.a,{path:"/configura\xe7\xf5es",component:T}),r.a.createElement(i.a,{path:"/user/:slug",exact:!0,render:function(e){return r.a.createElement(F,Object.assign({},e,{updateNotificationsNumber:h}))}}),r.a.createElement(i.a,{path:"/user/:slug/amigos",component:R}),r.a.createElement(i.a,{path:"/",component:E}))))}c.a.render(r.a.createElement(_,null),document.querySelector("#root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.3531badc.chunk.js.map